<!-- LIVE FIX TEST 1 -->
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>VonMesser Collection - Art Leads Culture</title>
    
    <!-- Meta tags for SEO and social sharing -->
    <meta name="description" content="A carefully curated assembly of contemporary and classical works exploring the intersection of traditional artistry and modern expression.">
    <meta name="keywords" content="art collection, contemporary art, classical art, curated collection, VonMesser, art gallery">
    <meta name="author" content="VonMesser Collection">
    
    <!-- Open Graph / Facebook / Instagram -->
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://vonmesser.xyz/">
    <meta property="og:title" content="VonMesser Collection - Art Leads Culture">
    <meta property="og:description" content="A carefully curated assembly of contemporary and classical works exploring the intersection of traditional artistry and modern expression.">
    <meta property="og:image" content="https://vonmesser.xyz/social-preview-square.png">
    <meta property="og:image:width" content="1080">
    <meta property="og:image:height" content="1080">
    
    <!-- Twitter -->
    <meta property="twitter:card" content="summary_large_image">
    <meta property="twitter:url" content="https://vonmesser.xyz/">
    <meta property="twitter:title" content="VonMesser Collection - Art Leads Culture">
    <meta property="twitter:description" content="A carefully curated assembly of contemporary and classical works exploring the intersection of traditional artistry and modern expression.">
    <meta property="twitter:image" content="https://vonmesser.xyz/social-preview.png">
    
    <!-- Favicon -->
    <link rel="icon" type="image/svg+xml" href="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMzIiIGhlaWdodD0iMzIiIHZpZXdCb3g9IjAgMCAzMiAzMiIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KICA8cmVjdCB3aWR0aD0iMzIiIGhlaWdodD0iMzIiIGZpbGw9IiNmZmZmZmYiLz4KICA8ZyBmaWxsPSIjMzMzIj4KICAgIDxwb2x5Z29uIHBvaW50cz0iOCwyIDEwLDIgMTMsOSAxNiwyIDE4LDIgMTQsMTIgMTEsMTIiLz4KICAgIDxwb2x5Z29uIHBvaW50cz0iMTksMiAyMSwyIDIzLDcgMjUsMiAyNywyIDI3LDEyIDI1LDEyIDI1LDUgMjMsOSAyMSw5IDIwLDUgMjAsMTIgMTksMTIiLz4KICA8L2c+CiAgPHRleHQgeD0iMTYiIHk9IjI3IiB0ZXh0LWFuY2hvcj0ibWlkZGxlIiBmaWxsPSIjMzMzIiBzdHlsZT0iZm9udC1mYW1pbHk6IHNhbnMtc2VyaWY7IGZvbnQtc2l6ZTogNXB4OyBmb250LXdlaWdodDogNDAwOyBsZXR0ZXItc3BhY2luZzogMC41cHg7Ij5WTTwvdGV4dD4KPC9zdmc+Cg==">
    <meta name="theme-color" content="#333333">
    
    <!-- Supabase -->
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    
    <!-- Google Fonts for Clean Typography -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500&display=swap" rel="stylesheet">
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        html {
            scroll-behavior: smooth;
        }
        
        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: #fafafa;
            color: #2c2c2c;
            line-height: 1.6;
            font-weight: 400;
            overflow-x: hidden;
            min-height: 100vh;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 0 40px;
        }
        
        /* Header */
        header {
            background: rgba(255, 255, 255, 0.95);
            position: fixed;
            width: 100%;
            top: 0;
            z-index: 1000;
            border-bottom: 1px solid #f0f0f0;
            box-shadow: 0 2px 20px rgba(0,0,0,0.08);
            backdrop-filter: blur(10px);
        }
        
        nav {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 25px 0;
            min-height: 80px;
        }
        
        .logo {
            display: flex;
            align-items: center;
            text-decoration: none;
            transition: opacity 0.3s ease;
        }
        
        .logo:hover {
            opacity: 0.8;
        }
        
        .nav-links {
            display: flex;
            list-style: none;
            gap: 50px;
            align-items: center;
            margin: 0;
            height: 100%;
        }
        
        .nav-links li {
            display: flex;
            align-items: center;
        }
        
        .nav-links a {
            text-decoration: none;
            color: #6b7280;
            font-weight: 400;
            font-size: 16px;
            text-transform: uppercase;
            letter-spacing: 1px;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            padding: 10px 0;
        }
        
        .nav-links a:hover {
            color: #1f2937;
        }
        
        /* Dropdown Menu */
        .dropdown {
            position: relative;
        }
        
        .dropdown-toggle::after {
            content: ' ▼';
            font-size: 10px;
            color: #9ca3af;
            margin-left: 5px;
        }
        
        .dropdown-menu {
            position: absolute;
            top: 100%;
            left: 0;
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border: 1px solid #e5e7eb;
            border-radius: 8px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.15);
            min-width: 200px;
            opacity: 0;
            visibility: hidden;
            transform: translateY(-10px);
            transition: all 0.3s ease;
            z-index: 1001;
            list-style: none;
            padding: 8px 0;
            margin: 8px 0 0 0;
        }
        
        .dropdown:hover .dropdown-menu {
            opacity: 1;
            visibility: visible;
            transform: translateY(0);
        }
        
        .dropdown-menu li {
            display: block;
        }
        
        .dropdown-menu a {
            display: block;
            padding: 12px 20px;
            color: #4b5563;
            font-size: 13px;
            text-decoration: none;
            transition: all 0.3s ease;
            border-radius: 0;
        }
        
        .dropdown-menu a:hover {
            background: #f9fafb;
            color: #1f2937;
        }
        
        /* Hero Tagline */
        .hero-tagline {
            margin-top: 120px;
            padding: 40px 0 30px;
            text-align: center;
            position: relative;
        }
        
        .tagline {
            font-size: clamp(3rem, 8vw, 7rem);
            font-weight: 900;
            color: #1f2937;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            line-height: 0.9;
            font-family: Impact, 'Arial Black', 'Helvetica Neue', Helvetica, sans-serif;
            position: relative;
            display: inline-block;
        }
        
        .tagline::before {
            content: '';
            position: absolute;
            top: 50%;
            left: -60px;
            width: 40px;
            height: 2px;
            background: linear-gradient(90deg, #1f2937 0%, #6b7280 100%);
            transform: translateY(-50%);
        }
        
        .tagline::after {
            content: '';
            position: absolute;
            top: 50%;
            right: -60px;
            width: 40px;
            height: 2px;
            background: linear-gradient(90deg, #6b7280 0%, #1f2937 100%);
            transform: translateY(-50%);
        }
        
        /* Admin Trigger */
        .admin-trigger {
            position: fixed;
            bottom: 30px;
            right: 30px;
            width: 20px;
            height: 20px;
            cursor: pointer;
            z-index: 999;
            opacity: 0.3;
            transition: all 0.3s ease;
        }
        
        .admin-trigger:hover {
            opacity: 0.8;
            transform: scale(1.2);
        }
        
        .admin-trigger svg {
            width: 100%;
            height: 100%;
        }
        
        /* Admin Panel */
        .admin-panel {
            position: fixed;
            top: 0;
            right: -420px;
            width: 400px;
            height: 100vh;
            background: linear-gradient(180deg, rgba(255,255,255,0.95) 0%, rgba(253,253,253,0.95) 100%);
            backdrop-filter: blur(20px);
            border-left: 1px solid rgba(240,240,240,0.8);
            z-index: 2000;
            transition: right 0.3s ease;
            overflow-y: auto;
            padding: 20px;
            box-shadow: -10px 0 40px rgba(0,0,0,0.12), -5px 0 15px rgba(0,0,0,0.08);
        }
        
        .admin-panel.open {
            right: 0;
        }
        
        .admin-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
            padding-bottom: 15px;
            border-bottom: 1px solid #f0f0f0;
        }
        
        .admin-title {
            font-size: 16px;
            font-weight: 400;
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        
        .close-admin {
            background: none;
            border: none;
            font-size: 20px;
            cursor: pointer;
            color: #999;
        }
        
        /* Form Styles */
        .admin-form {
            margin-bottom: 30px;
        }
        
        .form-group {
            margin-bottom: 20px;
        }
        
        .form-group label {
            display: block;
            font-family: 'Inter', sans-serif;
            font-size: 12px;
            text-transform: uppercase;
            letter-spacing: 1px;
            color: #4b5563;
            margin-bottom: 8px;
            font-weight: 500;
        }
        
        .form-group input,
        .form-group select,
        .form-group textarea {
            width: 100%;
            padding: 12px;
            border: 1px solid #d1d5db;
            background: #f9fafb;
            font-size: 14px;
            font-family: 'Inter', sans-serif;
            border-radius: 6px;
            transition: all 0.3s ease;
        }
        
        .form-group input:focus,
        .form-group select:focus,
        .form-group textarea:focus {
            outline: none;
            border-color: #1f2937;
            background: #ffffff;
            box-shadow: 0 0 0 3px rgba(31,41,55,0.1);
        }
        
        .file-upload {
            border: 2px dashed #e0e0e0;
            padding: 30px;
            text-align: center;
            cursor: pointer;
            transition: border-color 0.3s ease;
        }
        
        .file-upload:hover {
            border-color: #333;
        }
        
        .upload-text {
            font-size: 13px;
            color: #999;
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        
        /* Button Styles */
        .btn {
            padding: 12px 24px;
            border: 1px solid #1f2937;
            background: #ffffff;
            color: #1f2937;
            font-family: 'Inter', sans-serif;
            font-size: 12px;
            font-weight: 500;
            text-transform: uppercase;
            letter-spacing: 1px;
            cursor: pointer;
            transition: all 0.3s ease;
            width: 100%;
            border-radius: 6px;
        }
        
        .btn:hover {
            background: #1f2937;
            color: #ffffff;
            box-shadow: 0 4px 12px rgba(31,41,55,0.2);
        }
        
        .btn-danger {
            border-color: #e74c3c;
            color: #e74c3c;
        }
        
        .btn-danger:hover {
            background: #e74c3c;
            color: #ffffff;
        }
        
        .btn-small {
            padding: 6px 12px;
            font-size: 10px;
            width: auto;
        }
        
        /* Login Form */
        .login-form {
            padding: 30px;
            text-align: center;
        }
        
        .login-form h3 {
            font-size: 14px;
            font-weight: 400;
            text-transform: uppercase;
            letter-spacing: 1px;
            margin-bottom: 30px;
            color: #666;
        }
        
        .logout-section {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px;
            border: 1px solid #e0e0e0;
            margin-bottom: 20px;
            background: #f8f8f8;
        }
        
        .user-email {
            font-size: 12px;
            color: #666;
        }
        
        /* Main Content */
        main {
            padding: 40px 0 120px;
        }
        
        .page-title {
            display: none;
        }
        
        /* Gallery Grid */
        .gallery-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 30px;
            margin-bottom: 20px;
        }
        
        /* Search & Filter Controls */
        .gallery-controls {
            margin-bottom: 50px;
            display: flex;
            align-items: center;
            gap: 30px;
            padding: 20px 30px;
            background: rgba(255, 255, 255, 0.8);
            backdrop-filter: blur(10px);
            border-radius: 12px;
            border: 1px solid rgba(240, 240, 240, 0.8);
            box-shadow: 0 2px 20px rgba(0,0,0,0.04);
        }
        
        .search-filter-group {
            display: flex;
            gap: 20px;
            align-items: center;
            flex: 1;
        }
        
        .search-box {
            position: relative;
        }
        
        .search-input {
            padding: 12px 16px 12px 40px;
            border: 1px solid #e5e7eb;
            background: #ffffff;
            font-size: 13px;
            font-family: 'Inter', sans-serif;
            text-transform: uppercase;
            letter-spacing: 1px;
            width: 240px;
            transition: all 0.3s ease;
            border-radius: 8px;
            font-weight: 400;
        }
        
        .search-input:focus {
            outline: none;
            border-color: #1f2937;
            box-shadow: 0 0 0 3px rgba(31,41,55,0.1);
        }
        
        .search-input::placeholder {
            color: #9ca3af;
        }
        
        .search-icon {
            position: absolute;
            left: 14px;
            top: 50%;
            transform: translateY(-50%);
            color: #9ca3af;
            font-size: 14px;
        }
        
        .filter-group {
            display: flex;
            gap: 15px;
            align-items: center;
        }
        
        .filter-select {
            padding: 12px 16px;
            border: 1px solid #e5e7eb;
            background: #ffffff;
            font-size: 11px;
            font-family: 'Inter', sans-serif;
            font-weight: 500;
            text-transform: uppercase;
            letter-spacing: 1px;
            cursor: pointer;
            transition: all 0.3s ease;
            min-width: 120px;
            max-width: 140px;
            border-radius: 8px;
            color: #4b5563;
        }
        
        .filter-select:focus {
            outline: none;
            border-color: #1f2937;
            box-shadow: 0 0 0 3px rgba(31,41,55,0.1);
        }
        
        .controls-right {
            display: flex;
            align-items: center;
            gap: 20px;
        }
        
        .results-count {
            font-size: 11px;
            color: #6b7280;
            font-family: 'Inter', sans-serif;
            font-weight: 500;
            text-transform: uppercase;
            letter-spacing: 1px;
            white-space: nowrap;
        }
        
        .clear-filters {
            background: none;
            border: 1px solid #e5e7eb;
            padding: 12px 16px;
            font-size: 10px;
            font-family: 'Inter', sans-serif;
            font-weight: 500;
            text-transform: uppercase;
            letter-spacing: 1px;
            cursor: pointer;
            color: #6b7280;
            transition: all 0.3s ease;
            border-radius: 8px;
            white-space: nowrap;
        }
        
        .clear-filters:hover {
            border-color: #1f2937;
            color: #1f2937;
        }
        
        /* Artwork Cards */
        .artwork-card {
            cursor: pointer;
            position: relative;
            opacity: 0;
            transform: translateY(30px);
            transition: all 0.4s ease;
            border-radius: 8px;
            overflow: hidden;
            background: #ffffff;
            box-shadow: 0 4px 20px rgba(0,0,0,0.06);
        }
        
        .artwork-card.animate-in {
            opacity: 1;
            transform: translateY(0);
        }
        
        .artwork-card:hover {
            transform: translateY(-8px);
            box-shadow: 0 20px 40px rgba(0,0,0,0.12);
        }
        
        .artwork-image {
            width: 100%;
            background: #f8f8f8;
            margin-bottom: 0;
            overflow: hidden;
            position: relative;
        }
        
        .artwork-image img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            transition: opacity 0.3s ease;
            background: #f5f5f5;
        }
        
        .artwork-image img[data-lazy] {
            opacity: 0;
        }
        
        .artwork-image img.loaded {
            opacity: 1;
        }
        
        /* Loading spinner */
        .artwork-image::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 20px;
            height: 20px;
            margin: -10px 0 0 -10px;
            border: 2px solid #f0f0f0;
            border-top: 2px solid #ccc;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            opacity: 0;
            transition: opacity 0.3s ease;
        }
        
        .artwork-image:has(img[data-lazy])::before,
        .artwork-image:has(img:not(.loaded))::before {
            opacity: 1;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        /* Aspect ratios */
        .artwork-image.landscape { aspect-ratio: 4/3; }
        .artwork-image.portrait { aspect-ratio: 3/4; }
        .artwork-image.square { aspect-ratio: 1/1; }
        .artwork-image.panoramic { aspect-ratio: 16/9; }
        
        .artwork-info {
            text-align: left;
            padding: 20px;
            background: #ffffff;
        }
        
        .artwork-title {
            font-family: 'Inter', sans-serif;
            font-size: 13px;
            font-weight: 500;
            color: #1f2937;
            text-transform: uppercase;
            letter-spacing: 1px;
            margin-bottom: 8px;
            line-height: 1.3;
        }
        
        .artwork-details {
            font-family: 'Inter', sans-serif;
            font-size: 11px;
            color: #6b7280;
            text-transform: uppercase;
            letter-spacing: 1px;
            line-height: 1.4;
        }
        
        .artwork-artist {
            font-family: 'Inter', sans-serif;
            font-size: 11px;
            color: #4b5563;
            text-transform: uppercase;
            letter-spacing: 1px;
            margin-bottom: 3px;
        }
        
        .artwork-price {
            margin-top: 8px;
            color: #374151;
            font-weight: 500;
        }
        
        /* Simple Admin Controls */
        .admin-controls {
            position: absolute;
            top: 10px;
            right: 10px;
            opacity: 0;
            transition: opacity 0.3s ease;
            display: flex;
            gap: 5px;
        }
        
        .artwork-card:hover .admin-controls {
            opacity: 1;
        }
        
        .admin-btn {
            background: rgba(255, 255, 255, 0.9);
            border: 1px solid #ddd;
            padding: 6px 8px;
            cursor: pointer;
            font-size: 12px;
            border-radius: 3px;
            transition: all 0.2s ease;
            min-width: 28px;
            text-align: center;
        }
        
        .admin-btn:hover {
            background: #333;
            color: white;
            border-color: #333;
        }
        
        .admin-btn.danger:hover {
            background: #e74c3c;
            border-color: #e74c3c;
        }
        
        /* Simple Curation Controls */
        .curation-controls {
            position: fixed;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            padding: 15px 25px;
            border-radius: 30px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            display: none;
            gap: 15px;
            align-items: center;
            z-index: 1001;
            border: 1px solid #e0e0e0;
        }
        
        .curation-controls.show {
            display: flex;
        }
        
        .curation-btn {
            padding: 8px 16px;
            border: 1px solid #333;
            background: #ffffff;
            color: #333;
            font-size: 11px;
            text-transform: uppercase;
            letter-spacing: 1px;
            cursor: pointer;
            transition: all 0.3s ease;
            border-radius: 20px;
        }
        
        .curation-btn:hover {
            background: #333;
            color: #ffffff;
        }
        
        .curation-btn.saving {
            background: #28a745;
            border-color: #28a745;
            color: white;
        }
        
        .curation-status {
            font-size: 11px;
            color: #666;
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        
        /* Modal Styles */
        .modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.75);
            backdrop-filter: blur(8px);
            z-index: 3000;
            display: none;
            align-items: center;
            justify-content: center;
            padding: 40px;
        }
        
        .modal.show {
            display: flex;
        }
        
        .modal-content {
            background: #ffffff;
            max-width: 900px;
            width: 100%;
            max-height: 90vh;
            overflow-y: auto;
            position: relative;
            border-radius: 12px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.15);
            animation: modalSlideIn 0.3s ease;
        }
        
        @keyframes modalSlideIn {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        .modal-image-container {
            position: relative;
            background: #f8f8f8;
            display: flex;
            align-items: center;
            justify-content: center;
            min-height: 450px;
            max-height: 70vh;
            padding: 40px;
            border-radius: 12px 12px 0 0;
        }
        
        .modal-image {
            max-width: 100%;
            max-height: calc(70vh - 80px);
            object-fit: contain;
            cursor: zoom-in;
            transition: transform 0.3s ease;
            box-shadow: 0 4px 20px rgba(0,0,0,0.1);
        }
        
        .modal-image:hover {
            transform: scale(1.01);
        }
        
        .modal-image-container::after {
            content: '🔍';
            position: absolute;
            bottom: 15px;
            right: 15px;
            background: rgba(0, 0, 0, 0.7);
            color: white;
            padding: 8px 12px;
            border-radius: 20px;
            font-size: 14px;
            opacity: 0;
            transition: opacity 0.3s ease;
            pointer-events: none;
        }
        
        .modal-image-container:hover::after {
            opacity: 1;
        }
        
        .image-nav {
            position: absolute;
            top: 50%;
            transform: translateY(-50%);
            background: rgba(255, 255, 255, 0.9);
            border: none;
            padding: 15px 20px;
            cursor: pointer;
            font-size: 18px;
            color: #333;
            transition: all 0.3s ease;
        }
        
        .image-nav:hover {
            background: rgba(255, 255, 255, 1);
        }
        
        .image-nav.prev {
            left: 20px;
        }
        
        .image-nav.next {
            right: 20px;
        }
        
        .image-nav:disabled {
            opacity: 0.3;
            cursor: not-allowed;
        }
        
        .image-dots {
            position: absolute;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            display: flex;
            gap: 8px;
        }
        
        .dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.5);
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .dot.active {
            background: rgba(255, 255, 255, 1);
        }
        
        .modal-info {
            padding: 40px;
            background: #ffffff;
        }
        
        .modal-title {
            font-family: 'Inter', sans-serif;
            font-size: 20px;
            font-weight: 500;
            margin-bottom: 10px;
            text-transform: uppercase;
            letter-spacing: 1px;
            color: #1f2937;
            line-height: 1.2;
        }
        
        .modal-artist {
            font-family: 'Inter', sans-serif;
            font-size: 16px;
            color: #4b5563;
            text-transform: uppercase;
            letter-spacing: 1px;
            margin-bottom: 15px;
        }
        
        .modal-details {
            font-family: 'Inter', sans-serif;
            font-size: 14px;
            color: #6b7280;
            line-height: 1.6;
        }
        
        .modal-price {
            font-family: 'Inter', sans-serif;
            font-size: 18px;
            font-weight: 500;
            color: #1f2937;
            margin-top: 24px;
            padding-top: 24px;
            border-top: 1px solid #e5e7eb;
        }
        
        .close-modal {
            position: absolute;
            top: 20px;
            right: 20px;
            background: rgba(255, 255, 255, 0.9);
            border: none;
            padding: 15px;
            cursor: pointer;
            font-size: 18px;
            border-radius: 50%;
            width: 45px;
            height: 45px;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
        }
        
        .close-modal:hover {
            background: rgba(255, 255, 255, 1);
            transform: scale(1.1);
        }
        
        /* Zoom Modal */
        .zoom-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.92);
            backdrop-filter: blur(12px);
            z-index: 4000;
            display: none;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }
        
        .zoom-modal.show {
            display: flex;
        }
        
        .zoom-image {
            max-width: 95%;
            max-height: 95%;
            object-fit: contain;
            cursor: zoom-out;
        }
        
        .zoom-close {
            position: absolute;
            top: 30px;
            right: 30px;
            background: rgba(255, 255, 255, 0.9);
            border: none;
            padding: 15px;
            cursor: pointer;
            font-size: 20px;
            border-radius: 50%;
            width: 50px;
            height: 50px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        /* About & Contact Sections */
        .about-section, .contact-section {
            border-top: 1px solid #e5e7eb;
            padding: 80px 0;
            background: #fafafa;
        }
        
        .about-content, .contact-content {
            max-width: 700px;
            margin: 0 auto;
            text-align: center;
        }
        
        .about-content h2, .contact-content h2 {
            font-family: 'Inter', sans-serif;
            font-size: 13px;
            font-weight: 500;
            color: #6b7280;
            margin-bottom: 40px;
            letter-spacing: 2px;
            text-transform: uppercase;
        }
        
        .about-text {
            font-family: 'Crimson Text', serif;
            font-size: 18px;
            color: #4b5563;
            line-height: 1.8;
            text-align: left;
        }
        
        .about-text p {
            margin-bottom: 24px;
        }
        
        .about-text p:last-child {
            margin-bottom: 0;
        }
        
        .edit-about {
            margin-top: 40px;
            text-align: center;
        }
        
        .contact-content p {
            font-family: 'Crimson Text', serif;
            font-size: 16px;
            color: #4b5563;
            margin-bottom: 40px;
            max-width: 500px;
            margin-left: auto;
            margin-right: auto;
            line-height: 1.7;
        }
        
        .contact-email {
            color: #1f2937;
            text-decoration: none;
            font-family: 'Inter', sans-serif;
            font-size: 13px;
            font-weight: 500;
            text-transform: uppercase;
            letter-spacing: 1px;
            padding: 15px 0;
            border-bottom: 2px solid #1f2937;
            display: inline-block;
            transition: all 0.3s ease;
        }
        
        .contact-email:hover {
            color: #4b5563;
            border-bottom-color: #4b5563;
        }
        
        /* Footer */
        footer {
            border-top: 1px solid #e5e7eb;
            padding: 80px 0;
            text-align: center;
            background: #f8f8f8;
        }
        
        .loading {
            text-align: center;
            padding: 60px;
            color: #6b7280;
            font-family: 'Inter', sans-serif;
            font-size: 14px;
        }
        
        footer p {
            font-family: 'Inter', sans-serif;
            font-size: 10px;
            color: #9ca3af;
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        
        /* Empty State */
        .empty-gallery {
            text-align: center;
            padding: 120px 20px;
            color: #6b7280;
            width: 100%;
            max-width: 600px;
            margin: 0 auto;
            background: #ffffff;
            border-radius: 12px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.06);
        }
        
        .empty-gallery h3 {
            font-family: 'Inter', sans-serif;
            font-size: 16px;
            font-weight: 500;
            color: #1f2937;
            text-transform: uppercase;
            letter-spacing: 1px;
            margin-bottom: 20px;
        }
        
        .empty-gallery p {
            font-family: 'Inter', sans-serif;
            font-size: 14px;
            line-height: 1.6;
            color: #6b7280;
        }

        /* === CURATORS CORNER STYLES === */
        
        /* Article Cards */
        .articles-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
            gap: 40px;
            margin-bottom: 40px;
        }
        
        .article-card {
            background: #ffffff;
            border-radius: 16px;
            overflow: hidden;
            box-shadow: 0 4px 24px rgba(0,0,0,0.08);
            transition: all 0.4s ease;
            cursor: pointer;
            position: relative;
        }
        
        .article-card:hover {
            transform: translateY(-8px);
            box-shadow: 0 20px 40px rgba(0,0,0,0.12);
        }
        
        .article-header {
            padding: 30px;
            border-bottom: 1px solid #f0f0f0;
        }
        
        .article-meta {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-bottom: 20px;
        }
        
        .author-avatar {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            object-fit: cover;
            border: 2px solid #f0f0f0;
        }
        
        .author-info h4 {
            font-family: 'Inter', sans-serif;
            font-size: 14px;
            font-weight: 500;
            color: #1f2937;
            margin-bottom: 2px;
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        
        .author-info .author-title {
            font-size: 11px;
            color: #6b7280;
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        
        .article-title {
            font-family: 'Inter', sans-serif;
            font-size: 20px;
            font-weight: 500;
            color: #1f2937;
            line-height: 1.3;
            margin-bottom: 15px;
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        
        .article-excerpt {
            font-family: 'Inter', sans-serif;
            font-size: 14px;
            color: #6b7280;
            line-height: 1.6;
            margin-bottom: 20px;
        }
        
        .article-stats {
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-size: 11px;
            color: #9ca3af;
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        
        .article-date {
            font-weight: 500;
        }
        
        .read-time {
            opacity: 0.8;
        }
        
        /* Article Creation Form */
        .article-form {
            background: #ffffff;
            border-radius: 16px;
            padding: 40px;
            box-shadow: 0 4px 24px rgba(0,0,0,0.08);
            margin-bottom: 40px;
        }
        
        .form-section {
            margin-bottom: 30px;
        }
        
        .form-section h3 {
            font-family: 'Inter', sans-serif;
            font-size: 14px;
            font-weight: 500;
            color: #1f2937;
            text-transform: uppercase;
            letter-spacing: 1px;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 1px solid #f0f0f0;
        }
        
        .author-form-grid {
            display: grid;
            grid-template-columns: auto 1fr;
            gap: 20px;
            align-items: start;
        }
        
        .author-form-avatar {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            border: 2px dashed #e0e0e0;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: border-color 0.3s ease;
            overflow: hidden;
            position: relative;
        }
        
        .author-form-avatar:hover {
            border-color: #333;
        }
        
        .author-form-avatar img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        
        .author-form-fields {
            display: grid;
            gap: 15px;
        }
        
        .social-links-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
        }
        
        /* Rich Text Editor */
        .rich-editor {
            border: 1px solid #e5e7eb;
            border-radius: 8px;
            min-height: 400px;
            background: #ffffff;
            position: relative;
        }
        
        .editor-toolbar {
            padding: 15px 20px;
            border-bottom: 1px solid #f0f0f0;
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }
        
        .editor-btn {
            padding: 8px 12px;
            border: 1px solid #e5e7eb;
            background: #ffffff;
            color: #4b5563;
            font-size: 12px;
            cursor: pointer;
            border-radius: 6px;
            transition: all 0.3s ease;
            font-family: 'Inter', sans-serif;
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        
        .editor-btn:hover {
            border-color: #333;
            color: #333;
        }
        
        .editor-btn.active {
            background: #333;
            color: #ffffff;
            border-color: #333;
        }
        
        .editor-content {
            padding: 20px;
            min-height: 300px;
            outline: none;
            font-family: 'Inter', sans-serif;
            font-size: 16px;
            line-height: 1.6;
            color: #374151;
        }
        
        .editor-content:focus {
            outline: none;
        }
        
        /* Article Images */
        .article-images {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }
        
        .article-image-item {
            position: relative;
            aspect-ratio: 4/3;
            border-radius: 8px;
            overflow: hidden;
            background: #f8f8f8;
        }
        
        .article-image-item img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        
        .remove-image {
            position: absolute;
            top: 8px;
            right: 8px;
            background: rgba(239, 68, 68, 0.9);
            color: white;
            border: none;
            width: 24px;
            height: 24px;
            border-radius: 50%;
            cursor: pointer;
            font-size: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        /* Article Reading View */
        .article-reader {
            max-width: 800px;
            margin: 0 auto;
            background: #ffffff;
            border-radius: 16px;
            overflow: hidden;
            box-shadow: 0 4px 24px rgba(0,0,0,0.08);
        }
        
        .article-reader-header {
            padding: 50px 50px 30px;
            border-bottom: 1px solid #f0f0f0;
        }
        
        .article-reader-meta {
            display: flex;
            align-items: center;
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .article-reader-author {
            display: flex;
            align-items: center;
            gap: 15px;
        }
        
        .article-reader-avatar {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            object-fit: cover;
        }
        
        .article-reader-author-info h3 {
            font-family: 'Inter', sans-serif;
            font-size: 16px;
            font-weight: 500;
            color: #1f2937;
            margin-bottom: 3px;
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        
        .article-reader-author-info p {
            font-size: 12px;
            color: #6b7280;
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        
        .article-reader-stats {
            margin-left: auto;
            text-align: right;
            font-size: 11px;
            color: #9ca3af;
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        
        .article-reader-title {
            font-family: 'Inter', sans-serif;
            font-size: 32px;
            font-weight: 500;
            color: #1f2937;
            line-height: 1.2;
            text-transform: uppercase;
            letter-spacing: 1px;
            margin-bottom: 20px;
        }
        
        .author-social-links {
            display: flex;
            gap: 15px;
            margin-top: 15px;
        }
        
        .social-link {
            padding: 8px 12px;
            border: 1px solid #e5e7eb;
            background: #ffffff;
            color: #6b7280;
            font-size: 11px;
            text-decoration: none;
            border-radius: 6px;
            transition: all 0.3s ease;
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        
        .social-link:hover {
            border-color: #333;
            color: #333;
        }
        
        .article-content {
            padding: 40px 50px 50px;
            font-family: 'Inter', sans-serif;
            font-size: 16px;
            line-height: 1.7;
            color: #374151;
        }
        
        .article-content h1, .article-content h2, .article-content h3 {
            font-family: 'Inter', sans-serif;
            font-weight: 500;
            color: #1f2937;
            text-transform: uppercase;
            letter-spacing: 1px;
            margin: 30px 0 15px;
        }
        
        .article-content h1 { font-size: 24px; }
        .article-content h2 { font-size: 20px; }
        .article-content h3 { font-size: 16px; }
        
        .article-content p {
            margin-bottom: 20px;
            color: #374151 !important;
        }
        
        .article-content img {
            max-width: 100%;
            height: auto;
            border-radius: 8px;
            margin: 30px 0;
            box-shadow: 0 4px 20px rgba(0,0,0,0.1);
        }
        
        .article-content blockquote {
            border-left: 3px solid #333;
            padding-left: 20px;
            margin: 30px 0;
            font-style: italic;
            color: #6b7280;
        }
        
        /* Fix contrast issues for pasted content */
        .article-content * {
            color: #374151 !important;
        }
        
        .article-content strong,
        .article-content b {
            color: #1f2937 !important;
            font-weight: 600;
        }
        
        .article-content em,
        .article-content i {
            color: #374151 !important;
            font-style: italic;
        }
        
        .article-content a {
            color: #1f2937 !important;
            text-decoration: underline;
        }
        
        .article-content a:hover {
            color: #374151 !important;
        }
        
        /* Article images gallery */
        .article-images-gallery {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin: 30px 0;
        }
        
        .article-images-gallery img {
            width: 100%;
            height: auto;
            border-radius: 8px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.1);
            cursor: pointer;
            transition: transform 0.3s ease;
        }
        
        .article-images-gallery img:hover {
            transform: scale(1.02);
        }
        
        /* Dynamic Content (Tweets, etc.) */
        .embedded-tweet {
            background: #ffffff;
            border: 1px solid #e1e8ed;
            border-radius: 12px;
            padding: 20px;
            margin: 30px 0;
            font-family: 'Inter', sans-serif;
            max-width: 500px;
        }
        
        .tweet-author {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 15px;
        }
        
        .tweet-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: #f0f0f0;
        }
        
        .tweet-author-info h4 {
            font-size: 14px;
            font-weight: 500;
            color: #1f2937;
            margin: 0;
        }
        
        .tweet-author-info p {
            font-size: 12px;
            color: #6b7280;
            margin: 0;
        }
        
        .tweet-content {
            font-size: 15px;
            line-height: 1.5;
            color: #1f2937;
            margin-bottom: 15px;
        }
        
        .tweet-stats {
            display: flex;
            gap: 20px;
            font-size: 12px;
            color: #6b7280;
        }
        
        /* Floating Action Button */
        .fab-write {
            position: fixed;
            bottom: 30px;
            right: 30px;
            width: 60px;
            height: 60px;
            background: #1f2937;
            color: #ffffff;
            border: none;
            border-radius: 50%;
            cursor: pointer;
            font-size: 24px;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 4px 20px rgba(31, 41, 55, 0.3);
            transition: all 0.3s ease;
            z-index: 1000;
        }
        
        .fab-write:hover {
            transform: scale(1.1);
            box-shadow: 0 8px 30px rgba(31, 41, 55, 0.4);
        }
        
        /* Curators Corner Header */
        .corner-header {
            text-align: center;
            padding: 40px 0;
            border-bottom: 1px solid #f0f0f0;
            margin-bottom: 50px;
        }
        
        .corner-title {
            font-family: 'Inter', sans-serif;
            font-size: 28px;
            font-weight: 500;
            color: #1f2937;
            text-transform: uppercase;
            letter-spacing: 2px;
            margin-bottom: 15px;
        }
        
        .corner-subtitle {
            font-family: 'Inter', sans-serif;
            font-size: 14px;
            color: #6b7280;
            text-transform: uppercase;
            letter-spacing: 1px;
            max-width: 600px;
            margin: 0 auto;
        }
        
        /* Mobile Responsive for Curators Corner */
        @media (max-width: 768px) {
            .articles-grid {
                grid-template-columns: 1fr;
                gap: 30px;
            }
            
            .article-form {
                padding: 30px 20px;
            }
            
            .author-form-grid {
                grid-template-columns: 1fr;
                gap: 15px;
                text-align: center;
            }
            
            .social-links-grid {
                grid-template-columns: 1fr;
            }
            
            .article-reader {
                border-radius: 0;
                margin: 0 -20px;
            }
            
            .article-reader-header,
            .article-content {
                padding: 30px 20px;
            }
            
            .article-reader-meta {
                flex-direction: column;
                gap: 15px;
                text-align: center;
            }
            
            .article-reader-stats {
                margin-left: 0;
                text-align: center;
            }
            
            .article-reader-title {
                font-size: 24px;
            }
            
            .editor-toolbar {
                padding: 10px 15px;
            }
            
            .editor-btn {
                padding: 6px 10px;
                font-size: 11px;
            }
            
            .fab-write {
                bottom: 20px;
                right: 20px;
                width: 50px;
                height: 50px;
                font-size: 20px;
            }
            
            .article-images-gallery {
                grid-template-columns: 1fr;
                gap: 15px;
            }
        }
        
        /* Mobile Responsive */
        @media (max-width: 1200px) {
            .gallery-grid {
                grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
                gap: 25px;
            }
        }
        
        @media (max-width: 768px) {
            .container {
                padding: 0 20px;
            }
            
            .nav-links {
                gap: 25px;
            }
            
            .nav-links a {
                font-size: 13px;
                padding: 8px 0;
            }
            
            nav {
                padding: 20px 0;
                min-height: 70px;
            }
            
            .hero-tagline {
                padding: 30px 0 20px;
            }
            
            .tagline::before,
            .tagline::after {
                display: none;
            }
            
            .gallery-grid {
                grid-template-columns: 1fr;
                gap: 20px;
            }
            
            .admin-panel {
                width: 100%;
                right: -100%;
            }
            
            .modal {
                padding: 10px;
            }
            
            .modal-info {
                padding: 20px;
            }
            
            .modal-image-container {
                min-height: 250px;
                max-height: 50vh;
            }
            
            .zoom-close, .close-modal {
                width: 40px;
                height: 40px;
                font-size: 16px;
            }
            
            .zoom-close {
                top: 15px;
                right: 15px;
            }
            
            .gallery-controls {
                flex-direction: column;
                gap: 15px;
                padding: 20px;
                margin-bottom: 40px;
            }
            
            .search-filter-group {
                width: 100%;
                flex-direction: column;
                gap: 12px;
            }
            
            .search-input {
                width: 100%;
            }
            
            .filter-group {
                width: 100%;
                justify-content: space-between;
                gap: 8px;
            }
            
            .filter-select {
                flex: 1;
                min-width: auto;
                max-width: none;
            }
            
            .controls-right {
                width: 100%;
                flex-direction: column;
                gap: 12px;
                text-align: center;
            }
            
            .results-count,
            .clear-filters {
                width: 100%;
            }
            
            .artwork-card {
                transition: opacity 0.3s ease, transform 0.3s ease;
            }
            
            .artwork-card:hover .artwork-image {
                transform: none;
                box-shadow: none;
            }
            
            .curation-controls {
                bottom: 10px;
                padding: 12px 20px;
                border-radius: 25px;
            }
        }
    </style>
</head>
<body>
    <header>
        <nav class="container">
            <a href="#" class="logo">
                <svg width="102" height="38" viewBox="0 0 85 32" xmlns="http://www.w3.org/2000/svg">
                    <!-- VM monogram -->
                    <g fill="#333" style="font-weight: 400;">
                        <!-- V -->
                        <polygon points="24,3 27,3 32,17 35,3 38,3 31.5,19 28.5,19"/>
                        <!-- M -->
                        <polygon points="40,3 43,3 46,14 49,3 52,3 52,19 49.5,19 49.5,7 47.5,16 44.5,16 42.5,7 42.5,19 40,19"/>
                    </g>
                    
                    <!-- VONMESSER text -->
                    <text x="42.5" y="29" 
                          text-anchor="middle" 
                          fill="#333" 
                          style="font-family: -apple-system, BlinkMacSystemFont, sans-serif; 
                                 font-size: 6px; 
                                 font-weight: 400; 
                                 letter-spacing: 1.8px;">
                        VONMESSER
                    </text>
                </svg>
            </a>
            <ul class="nav-links">
                <li><a href="#" onclick="returnToMain()">Physical Collection</a></li>
                <li><a href="https://linktr.ee/flexasaurusrex" target="_blank" rel="noopener noreferrer">Digital Collection</a></li>
                <li class="dropdown">
                    <a href="#" class="dropdown-toggle">Guest Curators</a>
                    <ul class="dropdown-menu">
                        <li><a href="#" onclick="showFeaturedCurator()">Featured Curator</a></li>
                        <li><a href="#" onclick="showAllCurators()">Browse All Curators</a></li>
                        <li><a href="#" onclick="showCuratorApplication()">Apply to Curate</a></li>
                        <li><a href="#" onclick="toggleCuratorAuth()">Curator Login</a></li>
                    </ul>
                </li>
                <li><a href="#" onclick="showCuratorsCorner()">Curators Corner</a></li>
                <li><a href="#" onclick="scrollToSection('about')">About</a></li>
                <li><a href="#" onclick="scrollToSection('contact')">Contact</a></li>
            </ul>
        </nav>
    </header>

    <!-- Hero Tagline Section -->
    <section class="hero-tagline">
        <div class="container">
            <h1 class="tagline">Art Leads Culture</h1>
        </div>
    </section>

    <!-- Admin Trigger Diamond -->
    <div class="admin-trigger" onclick="toggleAdmin()">
        <svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg">
            <polygon points="10,2 18,10 10,18 2,10" 
                     fill="#333" 
                     stroke="none"/>
        </svg>
    </div>

    <!-- Admin Panel -->
    <div class="admin-panel" id="adminPanel">
        <div class="admin-header">
            <h3 class="admin-title">Admin Panel</h3>
            <button class="close-admin" onclick="toggleAdmin()">×</button>
        </div>
        
        <!-- Login Form -->
        <div class="login-form" id="loginForm">
            <h3>Admin Login</h3>
            <div class="form-group">
                <label for="loginEmail">Email</label>
                <input type="email" id="loginEmail" required>
            </div>
            <div class="form-group">
                <label for="loginPassword">Password</label>
                <input type="password" id="loginPassword" required>
            </div>
            <button class="btn" onclick="login()">Login</button>
        </div>

        <!-- Admin Content -->
        <div id="adminContent" style="display: none;">
            <div class="logout-section">
                <span class="user-email" id="userEmail"></span>
                <button class="btn btn-small" onclick="logout()">Logout</button>
            </div>
            
            <form class="admin-form" id="artworkForm">
                <input type="hidden" id="editingId" value="">
                
                <div class="form-group">
                    <label for="artworkTitle">Artwork Title</label>
                    <input type="text" id="artworkTitle" required>
                </div>
                
                <div class="form-group">
                    <label for="artistName">Artist Name</label>
                    <input type="text" id="artistName" required>
                </div>
                
                <div class="form-group">
                    <label for="artworkYear">Year</label>
                    <input type="text" id="artworkYear" required>
                </div>
                
                <div class="form-group">
                    <label for="artworkDimensions">Dimensions</label>
                    <input type="text" id="artworkDimensions" placeholder="e.g., 24 × 36 in or 61 × 91 cm">
                </div>
                
                <div class="form-group">
                    <label for="artworkMedium">Medium</label>
                    <input type="text" id="artworkMedium" placeholder="e.g., Oil on canvas, Archival pigment print on Hahnemühle Photo Rag 308, Mixed media">
                </div>
                
                <div class="form-group">
                    <label for="artworkPrice">Price (Optional)</label>
                    <input type="text" id="artworkPrice" placeholder="e.g., $5,000 or Price on Request">
                </div>
                
                <div class="form-group">
                    <label for="orientation">Orientation</label>
                    <select id="orientation" required>
                        <option value="landscape">Landscape (4:3)</option>
                        <option value="portrait">Portrait (3:4)</option>
                        <option value="square">Square (1:1)</option>
                        <option value="panoramic">Panoramic (16:9)</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label>Artwork Images</label>
                    <div class="file-upload" onclick="document.getElementById('imageUpload').click()">
                        <input type="file" id="imageUpload" style="display: none;" accept="image/*" multiple>
                        <div class="upload-text">Click to upload images (multiple allowed)</div>
                        <div style="font-size: 10px; color: #999; margin-top: 8px; text-transform: none; letter-spacing: 0;">
                            Tip: For best performance, use images under 2MB each
                        </div>
                    </div>
                    <div id="imagePreview" style="margin-top: 15px;"></div>
                </div>
                
                <button type="submit" class="btn">Add Artwork</button>
                <button type="button" class="btn" onclick="resetForm()" style="margin-top: 10px;">Clear Form</button>
            </form>
            
            <div class="admin-form" style="border-top: 1px solid #f0f0f0; padding-top: 30px; margin-top: 30px;">
                <h4 style="font-size: 12px; text-transform: uppercase; letter-spacing: 1px; color: #666; margin-bottom: 20px;">About Section</h4>
                
                <div class="form-group">
                    <label for="aboutText">About Text</label>
                    <textarea id="aboutText" rows="8" placeholder="Write about yourself as a collector and curator..."></textarea>
                </div>
                
                <button type="button" class="btn" onclick="saveAbout()">Update About</button>
            </div>
        
            <!-- Pending Curator Approvals -->
            <div class="admin-form" id="pendingCuratorsSection" style="border-top: 1px solid #f0f0f0; padding-top: 30px; margin-top: 30px; display: none;">
                <h4 style="font-size: 12px; text-transform: uppercase; letter-spacing: 1px; color: #666; margin-bottom: 20px;">Pending Curator Approvals</h4>
                <div id="pendingCuratorsList"></div>
            </div>
</div>
    </div>

    <!-- Zoom Modal -->
    <div class="zoom-modal" id="zoomModal">
        <button class="zoom-close" onclick="closeZoom()">×</button>
        <img class="zoom-image" id="zoomImage" src="" alt="" onclick="closeZoom()">
    </div>

    <!-- Artwork Modal -->
    <div class="modal" id="artworkModal">
        <div class="modal-content">
            <button class="close-modal" onclick="closeModal()">×</button>
            <div class="modal-image-container">
                <img class="modal-image" id="modalImage" src="" alt="" onclick="openZoom()">
                <button class="image-nav prev" id="prevBtn" onclick="changeImage(-1)">‹</button>
                <button class="image-nav next" id="nextBtn" onclick="changeImage(1)">›</button>
                <div class="image-dots" id="imageDots"></div>
            </div>
            <div class="modal-info">
                <h3 class="modal-title" id="modalTitle"></h3>
                <div class="modal-artist" id="modalArtist"></div>
                <div class="modal-details" id="modalDetails"></div>
                <div class="modal-price" id="modalPrice" style="display: none;"></div>
            </div>
        </div>
    </div>

    <!-- Curator Auth Modal -->
    <div class="modal" id="curatorAuthModal">
        <div class="modal-content" style="max-width: 500px;">
            <button class="close-modal" onclick="closeCuratorAuth()">×</button>
            
            <!-- Curator Login Form -->
            <div class="curator-auth-content" id="curatorLoginForm">
                <div style="padding: 40px;">
                    <h3 style="font-family: 'Inter', sans-serif; font-size: 18px; font-weight: 500; margin-bottom: 30px; text-align: center; color: #1f2937;">Curator Login</h3>
                    
                    <div class="form-group">
                        <label for="curatorLoginEmail">Email</label>
                        <input type="email" id="curatorLoginEmail" required>
                    </div>
                    <div class="form-group">
                        <label for="curatorLoginPassword">Password</label>
                        <input type="password" id="curatorLoginPassword" required>
                    </div>
                    <button class="btn" onclick="curatorLogin()">Login</button>
                    
                    <div style="text-align: center; margin-top: 20px;">
                        <button type="button" style="background: none; border: none; color: #6b7280; text-decoration: underline; cursor: pointer;" onclick="showCuratorRegister()">
                            New curator? Register here
                        </button>
                    </div>
                </div>
            </div>

            <!-- Curator Registration Form -->
            <div class="curator-auth-content" id="curatorRegisterForm" style="display: none;">
                <div style="padding: 40px;">
                    <h3 style="font-family: 'Inter', sans-serif; font-size: 18px; font-weight: 500; margin-bottom: 30px; text-align: center; color: #1f2937;">Curator Registration</h3>
                    
                    <div class="form-group">
                        <label for="curatorName">Curator Name</label>
                        <input type="text" id="curatorName" required>
                    </div>
                    <div class="form-group">
                        <label for="curatorEmail">Email</label>
                        <input type="email" id="curatorEmail" required>
                    </div>
                    <div class="form-group">
                        <label for="curatorPassword">Password</label>
                        <input type="password" id="curatorPassword" required>
                    </div>
                    <div class="form-group">
                        <label for="curatorBio">Bio (Optional)</label>
                        <textarea id="curatorBio" rows="3" placeholder="Tell us about your curatorial vision..."></textarea>
                    </div>
                    <div class="form-group">
                        <label>Profile Image</label>
                        <div class="file-upload" onclick="document.getElementById('curatorImageUpload').click()">
                            <input type="file" id="curatorImageUpload" style="display: none;" accept="image/*">
                            <div class="upload-text">Click to upload profile image</div>
                        </div>
                        <div id="curatorImagePreview" style="margin-top: 15px;"></div>
                    </div>
                    <button class="btn" onclick="curatorRegister()">Register</button>
                    
                    <div style="text-align: center; margin-top: 20px;">
                        <button type="button" style="background: none; border: none; color: #6b7280; text-decoration: underline; cursor: pointer;" onclick="showCuratorLogin()">
                            Already have an account? Login here
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Curator Dashboard Modal -->
    <div class="modal" id="curatorDashboardModal">
        <div class="modal-content" style="max-width: 600px;">
            <button class="close-modal" onclick="closeCuratorDashboard()">×</button>
            <div style="padding: 40px;">
                <div style="display: flex; align-items: center; gap: 20px; margin-bottom: 30px;">
                    <img id="curatorDashboardImage" src="" alt="" style="width: 80px; height: 80px; border-radius: 50%; object-fit: cover; background: #f8f8f8;">
                    <div>
                        <h3 id="curatorDashboardName" style="font-family: 'Inter', sans-serif; font-size: 20px; font-weight: 500; color: #1f2937; margin-bottom: 5px;"></h3>
                        <p style="color: #6b7280; font-size: 14px;">Curator Dashboard</p>
                    </div>
                </div>
                
                <div style="display: flex; gap: 15px; margin-bottom: 30px;">
                    <button class="btn" onclick="createCuratorCollection()" style="flex: 1;">Create Collection</button>
                    <button class="btn" onclick="editCuratorProfile()" style="flex: 1;">Edit Profile</button>
                    <button class="btn" onclick="curatorLogout()" style="flex: 1;">Logout</button>
                </div>
                
                <div id="curatorCollections">
                    <h4 style="font-size: 14px; font-weight: 500; color: #1f2937; margin-bottom: 15px; text-transform: uppercase; letter-spacing: 1px;">Your Collections</h4>
                    <div id="curatorCollectionsList"></div>
                </div>
            </div>
        </div>
    </div>

    <!-- Write Article Modal -->
    <div class="modal" id="writeArticleModal">
        <div class="modal-content" style="max-width: 900px; max-height: 95vh; overflow-y: auto;">
            <button class="close-modal" onclick="closeWriteArticle()">×</button>
            
            <div style="padding: 40px;">
                <h3 style="font-family: 'Inter', sans-serif; font-size: 24px; font-weight: 500; margin-bottom: 30px; text-align: center; color: #1f2937; text-transform: uppercase; letter-spacing: 1px;">Write Article</h3>
                
                <form id="articleForm">
                    <!-- Author Information -->
                    <div class="form-section">
                        <h3>Author Information</h3>
                        <div class="author-form-grid">
                            <div class="author-form-avatar" onclick="document.getElementById('authorAvatarUpload').click()">
                                <input type="file" id="authorAvatarUpload" style="display: none;" accept="image/*">
                                <span id="avatarPlaceholder" style="font-size: 12px; color: #9ca3af; text-align: center;">Click to add<br>profile photo</span>
                                <img id="authorAvatarPreview" src="" alt="" style="display: none;">
                            </div>
                            <div class="author-form-fields">
                                <div class="form-group">
                                    <label for="authorName">Author Name</label>
                                    <input type="text" id="authorName" required placeholder="Your full name">
                                </div>
                                <div class="form-group">
                                    <label for="authorTitle">Title/Position</label>
                                    <input type="text" id="authorTitle" placeholder="Art Critic, Curator, Artist, etc.">
                                </div>
                                <div class="form-group">
                                    <label for="authorBio">Short Bio</label>
                                    <textarea id="authorBio" rows="2" placeholder="Brief description about yourself..."></textarea>
                                </div>
                            </div>
                        </div>
                        
                        <div class="social-links-grid" style="margin-top: 20px;">
                            <div class="form-group">
                                <label for="authorWebsite">Website</label>
                                <input type="url" id="authorWebsite" placeholder="https://yourwebsite.com">
                            </div>
                            <div class="form-group">
                                <label for="authorTwitter">Twitter/X Handle</label>
                                <input type="text" id="authorTwitter" placeholder="@yourusername">
                            </div>
                            <div class="form-group">
                                <label for="authorInstagram">Instagram Handle</label>
                                <input type="text" id="authorInstagram" placeholder="@yourusername">
                            </div>
                            <div class="form-group">
                                <label for="authorLinkedIn">LinkedIn</label>
                                <input type="url" id="authorLinkedIn" placeholder="https://linkedin.com/in/yourprofile">
                            </div>
                        </div>
                    </div>
                    
                    <!-- Article Content -->
                    <div class="form-section">
                        <h3>Article Content</h3>
                        <div class="form-group">
                            <label for="articleTitle">Article Title</label>
                            <input type="text" id="articleTitle" required placeholder="Your compelling article title...">
                        </div>
                        
                        <div class="form-group">
                            <label for="articleExcerpt">Article Excerpt</label>
                            <textarea id="articleExcerpt" rows="3" placeholder="Brief summary that will appear in article previews..."></textarea>
                        </div>
                        
                        <div class="form-group">
                            <label>Article Content</label>
                            <div class="rich-editor">
                                <div class="editor-toolbar">
                                    <button type="button" class="editor-btn" onclick="formatText('bold')">Bold</button>
                                    <button type="button" class="editor-btn" onclick="formatText('italic')">Italic</button>
                                    <button type="button" class="editor-btn" onclick="formatText('underline')">Underline</button>
                                    <button type="button" class="editor-btn" onclick="formatText('insertOrderedList')">List</button>
                                    <button type="button" class="editor-btn" onclick="formatText('insertUnorderedList')">Bullets</button>
                                    <button type="button" class="editor-btn" onclick="formatText('formatBlock', 'h2')">Heading</button>
                                    <button type="button" class="editor-btn" onclick="formatText('formatBlock', 'blockquote')">Quote</button>
                                    <button type="button" class="editor-btn" onclick="insertLink()">Link</button>
                                    <button type="button" class="editor-btn" onclick="document.getElementById('articleImagesUpload').click()">Images</button>
                                </div>
                                <div class="editor-content" id="articleContent" contenteditable="true" placeholder="Start writing your article here...

You can paste Twitter links and they'll be automatically embedded as beautiful tweet cards. You can also add images, format text, and create rich content that will look amazing.

Try pasting a tweet URL like: https://twitter.com/username/status/123456789"></div>
                            </div>
                            <input type="file" id="articleImagesUpload" style="display: none;" accept="image/*" multiple>
                            <div class="article-images" id="articleImagesPreview"></div>
                        </div>
                    </div>
                    
                    <div style="display: flex; gap: 15px; justify-content: center; margin-top: 40px;">
                        <button type="button" class="btn" onclick="closeWriteArticle()" style="width: auto; padding: 12px 30px;">Cancel</button>
                        <button type="submit" class="btn" style="width: auto; padding: 12px 30px; background: #1f2937; color: #ffffff;">Publish Article</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Article Reader Modal -->
    <div class="modal" id="articleReaderModal">
        <div class="modal-content" style="max-width: 900px; max-height: 95vh; overflow-y: auto;">
            <button class="close-modal" onclick="closeArticleReader()">×</button>
            
            <div class="article-reader">
                <div class="article-reader-header">
                    <div class="article-reader-meta">
                        <div class="article-reader-author">
                            <img class="article-reader-avatar" id="readerAuthorAvatar" src="" alt="">
                            <div class="article-reader-author-info">
                                <h3 id="readerAuthorName"></h3>
                                <p id="readerAuthorTitle"></p>
                            </div>
                        </div>
                        <div class="article-reader-stats">
                            <div class="article-date" id="readerArticleDate"></div>
                            <div class="read-time" id="readerReadTime"></div>
                        </div>
                    </div>
                    <h1 class="article-reader-title" id="readerArticleTitle"></h1>
                    <div class="author-social-links" id="readerSocialLinks"></div>
                </div>
                <div class="article-content" id="readerArticleContent"></div>
            </div>
        </div>
    </div>

    <main>
        <div class="container">
            <!-- Search & Filter Controls -->
            <div class="gallery-controls" id="galleryControls" style="display: none;">
                <div class="search-filter-group">
                    <div class="search-box">
                        <span class="search-icon">🔍</span>
                        <input type="text" class="search-input" id="searchInput" placeholder="Search artworks...">
                    </div>
                    
                    <div class="filter-group">
                        <select class="filter-select" id="artistFilter">
                            <option value="">Artists</option>
                        </select>
                        
                        <select class="filter-select" id="yearFilter">
                            <option value="">Years</option>
                        </select>
                        
                        <select class="filter-select" id="mediumFilter">
                            <option value="">Mediums</option>
                        </select>
                    </div>
                </div>
                
                <div class="controls-right">
                    <div class="results-count" id="resultsCount">
                        <span id="resultNumber">0</span> pieces
                    </div>
                    
                    <button class="clear-filters" id="clearFilters">Clear</button>
                </div>
            </div>

            <div class="gallery-grid" id="galleryGrid">
                <div class="loading">Loading collection...</div>
            </div>

            <!-- Simple Curation Controls -->
            <div class="curation-controls" id="curationControls">
                <span class="curation-status">Use ↑↓ arrows to arrange</span>
                <button class="curation-btn" id="saveCuration">Save Arrangement</button>
                <button class="curation-btn" id="resetCuration">Reset to Date Order</button>
            </div>
        </div>
    </main>

    <!-- Floating Action Button for Writing (only shows in Curators Corner) -->
    <button class="fab-write" id="fabWrite" onclick="openWriteArticle()" style="display: none;">
        ✎
    </button>

    <section id="about" class="about-section">
        <div class="container">
            <div class="about-content">
                <h2>About</h2>
                <div class="about-text" id="aboutContent">
                    <p>Welcome to the VonMesser Collection, a carefully curated assembly of contemporary and classical works that explore the intersection of traditional artistry and modern expression.</p>
                    <p>As a collector and curator, I am drawn to pieces that challenge conventional boundaries while honoring the fundamental principles of artistic excellence. Each work in this collection has been selected for its unique voice, technical mastery, and ability to engage in dialogue with both historical precedent and contemporary discourse.</p>
                </div>
                <div class="edit-about" id="editAboutBtn" style="display: none;">
                    <button class="btn btn-small" onclick="editAbout()">Edit About</button>
                </div>
            </div>
        </div>
    </section>

    <section id="contact" class="contact-section">
        <div class="container">
            <div class="contact-content">
                <h2>Contact</h2>
                <p>Interested in learning more about the VonMesser Collection or inquiring about specific pieces? We welcome correspondence from collectors, curators, and art enthusiasts.</p>
                <a href="mailto:flex@vonmesser.xyz" class="contact-email">flex@vonmesser.xyz</a>
            </div>
        </div>
    </section>

    <footer>
        <div class="container">
            <p>&copy; 2024 VonMesser Collection</p>
        </div>
    </footer>

    <script>
        // Initialize Supabase
        const supabaseUrl = 'https://qqkshpkbfixeyusqpsou.supabase.co';
        const supabaseKey = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InFxa3NocGtiZml4ZXl1c3Fwc291Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDg5Mjc1ODksImV4cCI6MjA2NDUwMzU4OX0.EhAV5EvXDIRPJcp3ipBSqqo6xY6rh8Jghe__XZ4659U';
        const supabase = window.supabase.createClient(supabaseUrl, supabaseKey);

        let artworks = [];
        let filteredArtworks = [];
        let isAdminMode = false;
        let isAuthenticated = false;
        let currentModalImages = [];
        let currentImageIndex = 0;
        let aboutText = '';
        let animationObserver = null;
        let imageObserver = null;
        let hasUnsavedChanges = false;
        
        // Curator system variables
        let currentCurator = null;
        let isCuratorMode = false;
        let currentCollection = null;
        let allCurators = [];
        let currentPage = 'main'; // 'main', 'curator', 'browse-curators', 'curators-corner'
        
        // Curators Corner variables
        let articles = [];
        let filteredArticles = [];
        let currentArticleImages = [];
        let isEditingArticle = false;
        let editingArticleId = null;

        // Initialize on page load
        document.addEventListener('DOMContentLoaded', function() {
            checkAuthState();
            checkCuratorAuth();
            loadArtworks();
            loadAbout();
            loadCurators();
            loadArticles();
            initializeAnimations();
            initializeLazyLoading();
            setupSearchAndFilters();
            setupRichEditor();
        });

        // === CURATOR SYSTEM FUNCTIONS ===
        
        // Curator Authentication
        async function checkCuratorAuth() {
            // For this demo, we'll use memory-based storage instead of localStorage
            // In a real implementation, you'd use proper session management
            if (currentCurator) {
                isCuratorMode = true;
                console.log('Curator logged in:', currentCurator.name);
            }
        }

        function toggleCuratorAuth() {
            if (currentCurator) {
                showCuratorDashboard();
            } else {
                document.getElementById('curatorAuthModal').classList.add('show');
                showCuratorLogin();
            }
        }

        function closeCuratorAuth() {
            document.getElementById('curatorAuthModal').classList.remove('show');
        }

        function showCuratorLogin() {
            document.getElementById('curatorLoginForm').style.display = 'block';
            document.getElementById('curatorRegisterForm').style.display = 'none';
        }

        function showCuratorRegister() {
            document.getElementById('curatorLoginForm').style.display = 'none';
            document.getElementById('curatorRegisterForm').style.display = 'block';
        }

        async function curatorLogin() {
            const email = document.getElementById('curatorLoginEmail').value;
            const password = document.getElementById('curatorLoginPassword').value;
            
            if (!email || !password) {
                alert('Please enter both email and password');
                return;
            }

            try {
                // Query curators table
                const { data, error } = await supabase
                    .from('curators')
                    .select('*')
                    .eq('email', email)
                    .eq('password', password) // In production, use proper password hashing
                    .single();

                if (error) throw error;

                currentCurator = data;
                isCuratorMode = true;
                
                // Update admin panel to show curator is logged in
                updateAdminPanelForCurator();
                
                closeCuratorAuth();
                showCuratorDashboard();
                alert('Welcome back, ' + data.name + '!');
                
                // Clear form
                document.getElementById('curatorLoginEmail').value = '';
                document.getElementById('curatorLoginPassword').value = '';
            } catch (error) {
                console.error('Curator login error:', error);
                alert('Login failed. Please check your credentials.');
            }
        }

        function updateAdminPanelForCurator() {
  if (!currentCurator) return;

  // Change panel title & hide login
  document.querySelector('.admin-title').textContent = 'Curator Panel';
  document.getElementById('loginForm').style.display   = 'none';
  document.getElementById('adminContent').style.display = 'block';
  document.getElementById('userEmail').textContent     = currentCurator.email + ' (Curator)';

  // Add welcome message banner if not already there
  if (!document.getElementById('curatorAdminMessage')) {
    const msg = document.createElement('div');
    msg.id = 'curatorAdminMessage';
    msg.innerHTML = `
      <div style="padding:20px;background:#f8f8f8;border-radius:8px;margin-bottom:20px;text-align:center;">
        <h4 style="margin:0 0 10px;">Welcome, ${currentCurator.name}!</h4>
        <p>Manage your collection below.</p>
        <button class="btn" onclick="showCuratorDashboard()" style="padding:8px 16px;">Open Dashboard</button>
      </div>`;
    document.getElementById('adminContent').prepend(msg);
  }

  // Grab the artwork‐upload form and the About box
  const artworkForm  = document.getElementById('artworkForm');
  const aboutSection = document.querySelector('.admin-form:last-child');

  // ----- REPLACED HIDING WITH SHOWING -----
  // COMMENT OUT or REMOVE these hiding lines:
  // if (artworkForm) artworkForm.style.display = 'none';
  // if (aboutSection) aboutSection.style.display = 'none';

  // INSTEAD, force the curator to see the upload form:
  if (artworkForm) {
    artworkForm.style.display = 'block';
    // tweak the button label so it's clear
    const submitBtn = artworkForm.querySelector('button[type="submit"]');
    submitBtn.textContent = 'Add to My Collection';
  }
  // (optional) still hide the About‐update area if you like:
  if (aboutSection) aboutSection.style.display = 'none';

  // … any remaining bits of the function …
}


        async function curatorRegister() {
            const name = document.getElementById('curatorName').value;
            const email = document.getElementById('curatorEmail').value;
            const password = document.getElementById('curatorPassword').value;
            const bio = document.getElementById('curatorBio').value;
            
            if (!name || !email || !password) {
                alert('Please fill in all required fields');
                return;
            }

            try {
                let profileImage = '';
                const imageFile = document.getElementById('curatorImageUpload').files[0];
                
                if (imageFile) {
                    profileImage = await compressImage(imageFile, 200, 0.8);
                }

                const { data, error } = await supabase
                    .from('curators')
                    .insert([{
                        name: name,
                        email: email,
                        password: password, // In production, hash this
                        bio: bio,
                        profile_image: profileImage,
                        status: 'pending'
                    }])
                    .select()
                    .single();

                if (error) throw error;

                alert('Registration successful! You can now login.');
                showCuratorLogin();
                
                // Clear form
                document.getElementById('curatorName').value = '';
                document.getElementById('curatorEmail').value = '';
                document.getElementById('curatorPassword').value = '';
                document.getElementById('curatorBio').value = '';
                document.getElementById('curatorImagePreview').innerHTML = '';
                
            } catch (error) {
                console.error('Curator registration error:', error);
                alert('Registration failed: ' + error.message);
            }
        }

        function curatorLogout() {
            currentCurator = null;
            isCuratorMode = false;
            
            // Reset admin panel to normal state
            resetAdminPanelFromCurator();
            
            closeCuratorDashboard();
            alert('Logged out successfully');
        }

        function resetAdminPanelFromCurator() {
            // Reset admin panel title
            document.querySelector('.admin-title').textContent = 'Admin Panel';
            
            // Remove curator message if it exists
            const curatorMessage = document.getElementById('curatorAdminMessage');
            if (curatorMessage) {
                curatorMessage.remove();
            }
            
            // Show normal admin forms
            const artworkForm = document.getElementById('artworkForm');
            const aboutSection = document.querySelector('.admin-form:last-child');
            
            if (artworkForm) artworkForm.style.display = 'block';
            if (aboutSection) aboutSection.style.display = 'block';
            
            // Reset to normal login state
            document.getElementById('loginForm').style.display = 'block';
            document.getElementById('adminContent').style.display = 'none';
        }

        // Curator Dashboard
        function showCuratorDashboard() {
            if (!currentCurator) return;
            
            document.getElementById('curatorDashboardName').textContent = currentCurator.name;
            document.getElementById('curatorDashboardImage').src = currentCurator.profile_image || 'data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iODAiIGhlaWdodD0iODAiIHZpZXdCb3g9IjAgMCA4MCA4MCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48Y2lyY2xlIGN4PSI0MCIgY3k9IjQwIiByPSI0MCIgZmlsbD0iI2Y4ZjhmOCIvPjx0ZXh0IHg9IjQwIiB5PSI0NSIgdGV4dC1hbmNob3I9Im1pZGRsZSIgZmlsbD0iIzZiNzI4MCIgZm9udC1zaXplPSIxNCIgZm9udC1mYW1pbHk9IkludGVyIj7wn5+kPC90ZXh0Pjwvc3ZnPg==';
            
            loadCuratorCollections();
            document.getElementById('curatorDashboardModal').classList.add('show');
        }

        function closeCuratorDashboard() {
            document.getElementById('curatorDashboardModal').classList.remove('show');
        }

        async function loadCuratorCollections() {
            if (!currentCurator) return;
            
            try {
                const { data, error } = await supabase
                    .from('curator_collections')
                    .select('*')
                    .eq('curator_id', currentCurator.id)
                    .order('created_at', { ascending: false });

                if (error) throw error;

                const listContainer = document.getElementById('curatorCollectionsList');
                if (data && data.length > 0) {
                    listContainer.innerHTML = data.map(collection => `
                        <div style="padding: 15px; border: 1px solid #e5e7eb; border-radius: 8px; margin-bottom: 10px; background: #f9fafb;">
                            <div style="display: flex; justify-content: space-between; align-items: center;">
                                <div>
                                    <h5 style="font-weight: 500; color: #1f2937; margin-bottom: 5px;">${collection.name}</h5>
                                    <p style="font-size: 12px; color: #6b7280; text-transform: uppercase;">${collection.type} Collection</p>
                                </div>
                                <button onclick="openCuratorCollection('${collection.id}')" style="padding: 8px 12px; border: 1px solid #e5e7eb; background: white; border-radius: 6px; font-size: 11px; cursor: pointer;">
                                    Manage
                                </button>
                            </div>
                        </div>
                    `).join('');
                } else {
                    listContainer.innerHTML = '<p style="color: #6b7280; text-align: center; padding: 20px;">No collections yet. Create your first collection!</p>';
                }
            } catch (error) {
                console.error('Error loading curator collections:', error);
            }
        }

        async function createCuratorCollection() {
            if (!currentCurator) return;
            
            const name = prompt('Collection Name:');
            if (!name) return;
            
            // Better way to ask for collection type
            let type = prompt('Collection Type: Enter "physical" or "digital":', 'physical');
            if (!type) return;
            
            type = type.toLowerCase();
            if (type !== 'physical' && type !== 'digital') {
                alert('Please enter either "physical" or "digital"');
                return;
            }
            
            const description = prompt('Collection Description (optional):') || '';
            
            try {
                const { data, error } = await supabase
                    .from('curator_collections')
                    .insert([{
                        curator_id: currentCurator.id,
                        name: name,
                        type: type,
                        description: description
                    }])
                    .select()
                    .single();

                if (error) throw error;

                alert('Collection created successfully!');
                await loadCuratorCollections();
            } catch (error) {
                console.error('Error creating collection:', error);
                alert('Failed to create collection: ' + error.message);
            }
        }

        function editCuratorProfile() {
            alert('Profile editing feature coming soon!');
        }

        function openCuratorCollection(collectionId) {
            // Navigate to curator collection page
            currentCollection = collectionId;
            closeCuratorDashboard();
            loadCuratorPage(currentCurator.id, collectionId);
        }

        // Curator Pages
        async function loadCuratorPage(curatorId, collectionId) {
            currentPage = 'curator';
            
            try {
                // Load curator info
                const { data: curator, error: curatorError } = await supabase
                    .from('curators')
                    .select('*')
                    .eq('id', curatorId)
                    .single();

                if (curatorError) {
                    console.error('Error loading curator:', curatorError);
                    alert('Failed to load curator information');
                    return;
                }

                // Load collection info
                const { data: collection, error: collectionError } = await supabase
                    .from('curator_collections')
                    .select('*')
                    .eq('id', collectionId)
                    .single();

                if (collectionError) {
                    console.error('Error loading collection:', collectionError);
                    alert('Failed to load collection information');
                    return;
                }

                // Load collection artworks (this might be empty, which is fine)
                const { data: collectionArtworks, error: artworksError } = await supabase
                    .from('curator_artworks')
                    .select('*')
                    .eq('collection_id', collectionId)
                    .order('display_order', { ascending: true, nullsLast: true })
                    .order('created_at', { ascending: false });

                // Don't throw error if no artworks found, just log it
                if (artworksError) {
                    console.error('Error loading artworks (non-critical):', artworksError);
                }

                // Update page content
                artworks = collectionArtworks || [];
                filteredArtworks = [...artworks];
                
                // Update header tagline to show curator info
                try {
                    document.querySelector('.tagline').innerHTML = `
                        <div style="display: flex; flex-direction: column; align-items: center;">
                            <div style="font-size: 0.3em; font-weight: 400; margin-bottom: 10px; color: #6b7280;">${curator.name}</div>
                            <div>${collection.name}</div>
                            <div style="font-size: 0.4em; font-weight: 400; margin-top: 10px; color: #6b7280;">${collection.type.toUpperCase()} COLLECTION</div>
                        </div>
                    `;
                } catch (taglineError) {
                    console.error('Error updating tagline (non-critical):', taglineError);
                }
                
                // These functions might have minor errors but shouldn't block page load
                try {
                    populateFilterDropdowns();
                } catch (filterError) {
                    console.error('Error populating filters (non-critical):', filterError);
                }
                
                try {
                    renderGallery();
                } catch (renderError) {
                    console.error('Error rendering gallery (non-critical):', renderError);
                }
                
                // Show admin controls if this is the current curator's collection
                try {
                    if (currentCurator && currentCurator.id === curatorId) {
                        // Enable curator admin mode
                        isAdminMode = true;
                        isAuthenticated = true;
                        renderGallery();
                    }
                } catch (adminError) {
                    console.error('Error setting admin mode (non-critical):', adminError);
                }
                
                // Add back to main navigation
                try {
                    addBackToMainButton();
                } catch (buttonError) {
                    console.error('Error adding back button (non-critical):', buttonError);
                }
                
            } catch (error) {
                console.error('Critical error loading curator page:', error);
                // Only show alert for truly critical errors
                if (error.message && error.message.includes('Failed to fetch')) {
                    alert('Network error - please check your connection and try again');
                } else {
                    alert('Failed to load curator page');
                }
            }
        }

        // Browse Curators
        async function loadCurators() {
            try {
                const { data, error } = await supabase
                    .from('curators')
                    .select('*')
                    .eq('status', 'approved')
                    .order('created_at', { ascending: false });

                if (error) throw error;
                allCurators = data || [];
            } catch (error) {
                console.error('Error loading curators:', error);
            }
        }

        function showAllCurators() {
            currentPage = 'browse-curators';
            
            // Update header tagline
            document.querySelector('.tagline').textContent = 'GUEST CURATORS';
            
            // Update gallery to show curators
            const grid = document.getElementById('galleryGrid');
            if (allCurators.length === 0) {
                grid.innerHTML = `
                    <div class="empty-gallery">
                        <h3>No Curators Yet</h3>
                        <p>Be the first to join our curatorial community!</p>
                    </div>
                `;
            } else {
                grid.innerHTML = allCurators.map(curator => `
                    <div class="artwork-card" onclick="showCuratorProfile('${curator.id}')">
                        <div class="artwork-image square">
                            <img src="${curator.profile_image || 'data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMzAwIiBoZWlnaHQ9IjMwMCIgdmlld0JveD0iMCAwIDMwMCAzMDAiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PHJlY3Qgd2lkdGg9IjMwMCIgaGVpZ2h0PSIzMDAiIGZpbGw9IiNmOGY4ZjgiLz48dGV4dCB4PSIxNTAiIHk9IjE2MCIgdGV4dC1hbmNob3I9Im1pZGRsZSIgZmlsbD0iIzZiNzI4MCIgZm9udC1zaXplPSI0OCIgZm9udC1mYW1pbHk9IkludGVyIj7wn5+kPC90ZXh0Pjwvc3ZnPg=='}" alt="${curator.name}" onload="this.classList.add('loaded')">
                        </div>
                        <div class="artwork-info">
                            <div class="artwork-title">${curator.name}</div>
                            <div class="artwork-details">
                                <div class="artwork-artist">Curator</div>
                                <div>Joined ${new Date(curator.created_at).getFullYear()}</div>
                                ${curator.bio ? `<div style="margin-top: 8px; font-style: italic; text-transform: none;">${curator.bio.substring(0, 100)}${curator.bio.length > 100 ? '...' : ''}</div>` : ''}
                            </div>
                        </div>
                    </div>
                `).join('');
            }
            
            // Hide search controls for curator browse
            document.getElementById('galleryControls').style.display = 'none';
            
            // Add back to main navigation
            addBackToMainButton();
        }

        async function showCuratorProfile(curatorId) {
            // Load first collection for this curator
            try {
                const { data: collections, error } = await supabase
                    .from('curator_collections')
                    .select('*')
                    .eq('curator_id', curatorId)
                    .limit(1);

                if (error) throw error;

                if (collections && collections.length > 0) {
                    loadCuratorPage(curatorId, collections[0].id);
                } else {
                    alert('This curator has no collections yet.');
                }
            } catch (error) {
                console.error('Error loading curator profile:', error);
            }
        }

        function showFeaturedCurator() {
            // For now, show the first curator
            if (allCurators.length > 0) {
                showCuratorProfile(allCurators[0].id);
            } else {
                alert('No featured curator available.');
            }
        }

        function showCuratorApplication() {
            document.getElementById('curatorAuthModal').classList.add('show');
            showCuratorRegister();
        }

        function addBackToMainButton() {
            const container = document.querySelector('.container');
            let backButton = document.getElementById('backToMain');
            
            if (!backButton) {
                backButton = document.createElement('div');
                backButton.id = 'backToMain';
                backButton.innerHTML = `
                    <button onclick="returnToMain()" style="
                        margin-bottom: 30px; 
                        padding: 12px 20px; 
                        background: rgba(255,255,255,0.9); 
                        border: 1px solid #e5e7eb; 
                        border-radius: 8px; 
                        color: #6b7280; 
                        font-size: 12px; 
                        text-transform: uppercase; 
                        letter-spacing: 1px; 
                        cursor: pointer;
                        transition: all 0.3s ease;
                    " onmouseover="this.style.borderColor='#1f2937'; this.style.color='#1f2937';" onmouseout="this.style.borderColor='#e5e7eb'; this.style.color='#6b7280';">
                        ← Back to Main Collection
                    </button>
                `;
                container.insertBefore(backButton, document.getElementById('galleryControls'));
            }
        }

        function returnToMain() {
            currentPage = 'main';
            currentCollection = null;
            
            // Don't automatically logout curators when returning to main
            // They should be able to navigate between sections while staying logged in
            if (!isAuthenticated && !currentCurator) {
                isAdminMode = false;
            }
            
            // Reset header
            document.querySelector('.tagline').textContent = 'ART LEADS CULTURE';
            
            // Hide FAB
            document.getElementById('fabWrite').style.display = 'none';
            
            // Remove back button
            const backButton = document.getElementById('backToMain');
            if (backButton) backButton.remove();
            
            // Reload main collection
            loadArtworks();
            
            // Check admin auth (this will maintain curator login state)
            checkAuthState();
        }

        // === CURATORS CORNER FUNCTIONS ===
        
        async function showCuratorsCorner() {
            currentPage = 'curators-corner';
            
            // Update header tagline
            document.querySelector('.tagline').innerHTML = `
                <div style="display: flex; flex-direction: column; align-items: center;">
                    <div>CURATORS CORNER</div>
                    <div style="font-size: 0.4em; font-weight: 400; margin-top: 10px; color: #6b7280;">ARTICLES & INSIGHTS</div>
                </div>
            `;
            
            // Show FAB
            document.getElementById('fabWrite').style.display = 'flex';
            
            // Hide search controls
            document.getElementById('galleryControls').style.display = 'none';
            
            // Load and render articles
            await loadArticles();
            renderArticles();
            
            // Add back to main navigation
            addBackToMainButton();
        }
        
        async function loadArticles() {
            try {
                // Try to load from database first
                const { data, error } = await supabase
                    .from('articles')
                    .select('*')
                    .order('created_at', { ascending: false });

                if (error) {
                    console.warn('Could not load from database, using demo data:', error);
                    // Fallback to demo data if table doesn't exist
                    if (articles.length === 0) {
                        articles = [
                            {
                                id: 'sample_1',
                                title: 'The Evolution of Digital Art in Contemporary Galleries',
                                excerpt: 'Exploring how digital mediums are reshaping the traditional gallery experience and what it means for collectors.',
                                content: '<p>The art world is experiencing a profound transformation as digital mediums increasingly find their place within the hallowed halls of contemporary galleries...</p>',
                                author_name: 'Alexandra Chen',
                                author_title: 'Digital Art Curator',
                                author_bio: 'Curator specializing in new media and digital art forms',
                                author_avatar: 'data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTAwIiBoZWlnaHQ9IjEwMCIgdmlld0JveD0iMCAwIDEwMCAxMDAiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PGNpcmNsZSBjeD0iNTAiIGN5PSI1MCIgcj0iNTAiIGZpbGw9IiNmMGYwZjAiLz48dGV4dCB4PSI1MCIgeT0iNjAiIHRleHQtYW5jaG9yPSJtaWRkbGUiIGZpbGw9IiM2NjYiIGZvbnQtc2l6ZT0iMjQiIGZvbnQtZmFtaWx5PSJJbnRlciI+QUM8L3RleHQ+PC9zdmc+',
                                author_website: '',
                                author_twitter: '@alexarttech',
                                author_instagram: '',
                                author_linkedin: '',
                                created_at: new Date(Date.now() - 86400000).toISOString(),
                                images: []
                            },
                            {
                                id: 'sample_2',
                                title: 'Collecting in the Age of Social Media',
                                excerpt: 'How Instagram and TikTok are influencing art collection trends and discovery patterns among younger demographics.',
                                content: '<p>Social media platforms have fundamentally altered how we discover, discuss, and desire art...</p>',
                                author_name: 'Marcus Rodriguez',
                                author_title: 'Art Market Analyst',
                                author_bio: 'Analyzing trends and patterns in contemporary art markets',
                                author_avatar: 'data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTAwIiBoZWlnaHQ9IjEwMCIgdmlld0JveD0iMCAwIDEwMCAxMDAiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PGNpcmNsZSBjeD0iNTAiIGN5PSI1MCIgcj0iNTAiIGZpbGw9IiNmMGYwZjAiLz48dGV4dCB4PSI1MCIgeT0iNjAiIHRleHQtYW5jaG9yPSJtaWRkbGUiIGZpbGw9IiM2NjYiIGZvbnQtc2l6ZT0iMjQiIGZvbnQtZmFtaWx5PSJJbnRlciI+TVI8L3RleHQ+PC9zdmc+',
                                author_website: 'https://artmarketinsights.com',
                                author_twitter: '@marcusart',
                                author_instagram: '@artmarketanalyst',
                                author_linkedin: '',
                                created_at: new Date(Date.now() - 172800000).toISOString(),
                                images: []
                            }
                        ];
                    }
                } else {
                    // Successfully loaded from database
                    articles = data || [];
                    console.log('Loaded', articles.length, 'articles from database');
                }
                
                filteredArticles = [...articles];
                
            } catch (error) {
                console.error('Error loading articles:', error);
                articles = [];
                filteredArticles = [];
            }
        }
        
        function renderArticles() {
            const grid = document.getElementById('galleryGrid');
            
            if (articles.length === 0) {
                grid.innerHTML = `
                    <div class="empty-gallery">
                        <h3>No Articles Yet</h3>
                        <p>Be the first to share insights about the art world.<br>Click the write button to get started.</p>
                    </div>
                `;
                return;
            }

            grid.innerHTML = filteredArticles.map(article => {
                const readTime = calculateReadTime(article.content, article.images);
                const publishedDate = new Date(article.created_at).toLocaleDateString('en-US', {
                    year: 'numeric',
                    month: 'short',
                    day: 'numeric'
                });
                
                return `
                    <div class="article-card" onclick="openArticleReader('${article.id}')">
                        <div class="article-header">
                            <div class="article-meta">
                                <img class="author-avatar" src="${article.author_avatar || generateAvatarPlaceholder(article.author_name)}" alt="${article.author_name}">
                                <div class="author-info">
                                    <h4>${article.author_name}</h4>
                                    <div class="author-title">${article.author_title || 'Contributor'}</div>
                                </div>
                            </div>
                            <h3 class="article-title">${article.title}</h3>
                            <p class="article-excerpt">${article.excerpt || extractExcerpt(article.content)}</p>
                            <div class="article-stats">
                                <span class="article-date">${publishedDate}</span>
                                <span class="read-time">${readTime} min read</span>
                            </div>
                        </div>
                    </div>
                `;
            }).join('');

            setTimeout(() => {
                animateArtworkCards();
            }, 10);
        }
        
        function openWriteArticle() {
            document.getElementById('writeArticleModal').classList.add('show');
            // Focus on author name field
            setTimeout(() => {
                document.getElementById('authorName').focus();
            }, 300);
        }
        
        function closeWriteArticle() {
            document.getElementById('writeArticleModal').classList.remove('show');
            resetArticleForm();
        }
        
        function resetArticleForm() {
            document.getElementById('articleForm').reset();
            document.getElementById('authorAvatarPreview').style.display = 'none';
            document.getElementById('avatarPlaceholder').style.display = 'block';
            document.getElementById('articleContent').innerHTML = '';
            document.getElementById('articleImagesPreview').innerHTML = '';
            currentArticleImages = [];
            isEditingArticle = false;
            editingArticleId = null;
        }
        
        // Rich Text Editor Functions
        function setupRichEditor() {
            const editor = document.getElementById('articleContent');
            
            editor.addEventListener('paste', function(e) {
                setTimeout(() => {
                    processDynamicContent(editor);
                }, 100);
            });
            
            editor.addEventListener('input', function(e) {
                processDynamicContent(editor);
            });
        }
        
        function formatText(command, value = null) {
            document.execCommand(command, false, value);
            document.getElementById('articleContent').focus();
        }
        
        function insertLink() {
            const url = prompt('Enter URL:');
            if (url) {
                document.execCommand('createLink', false, url);
            }
            document.getElementById('articleContent').focus();
        }
        
        function processDynamicContent(editor) {
            const content = editor.innerHTML;
            let newContent = content;
            
            // Process Twitter URLs
            const twitterRegex = /https?:\/\/(www\.)?(twitter\.com|x\.com)\/\w+\/status\/(\d+)/g;
            newContent = newContent.replace(twitterRegex, (match) => {
                return createTwitterEmbed(match);
            });
            
            if (newContent !== content) {
                editor.innerHTML = newContent;
                // Move cursor to end
                const range = document.createRange();
                const sel = window.getSelection();
                range.selectNodeContents(editor);
                range.collapse(false);
                sel.removeAllRanges();
                sel.addRange(range);
            }
        }
        
        function createTwitterEmbed(url) {
            // Extract tweet ID from URL
            const tweetId = url.match(/status\/(\d+)/)?.[1];
            if (!tweetId) return url;
            
            return `
                <div class="embedded-tweet" data-tweet-url="${url}">
                    <div class="tweet-author">
                        <div class="tweet-avatar"></div>
                        <div class="tweet-author-info">
                            <h4>Twitter Post</h4>
                            <p>@username</p>
                        </div>
                    </div>
                    <div class="tweet-content">
                        This tweet will be dynamically loaded when the article is published.
                        <br><br>
                        <em>URL: ${url}</em>
                    </div>
                    <div class="tweet-stats">
                        <span>🔄 Retweets</span>
                        <span>❤️ Likes</span>
                        <span>💬 Replies</span>
                    </div>
                </div>
            `;
        }
        
        // Article Image Handling
        document.getElementById('articleImagesUpload').addEventListener('change', async function() {
            const files = this.files;
            const preview = document.getElementById('articleImagesPreview');
            
            for (let i = 0; i < files.length; i++) {
                const file = files[i];
                const compressedImage = await compressImage(file, 800, 0.8);
                currentArticleImages.push(compressedImage);
                
                const imageItem = document.createElement('div');
                imageItem.className = 'article-image-item';
                imageItem.innerHTML = `
                    <img src="${compressedImage}" alt="Article image">
                    <button class="remove-image" onclick="removeArticleImage(${currentArticleImages.length - 1})" type="button">×</button>
                `;
                preview.appendChild(imageItem);
            }
        });
        
        function removeArticleImage(index) {
            currentArticleImages.splice(index, 1);
            const preview = document.getElementById('articleImagesPreview');
            preview.children[index].remove();
        }
        
        // Author Avatar Handling
        document.getElementById('authorAvatarUpload').addEventListener('change', async function() {
            const file = this.files[0];
            if (file) {
                const compressedImage = await compressImage(file, 200, 0.8);
                const preview = document.getElementById('authorAvatarPreview');
                const placeholder = document.getElementById('avatarPlaceholder');
                
                preview.src = compressedImage;
                preview.style.display = 'block';
                placeholder.style.display = 'none';
            }
        });
        
        // Article Submission
        document.getElementById('articleForm').addEventListener('submit', async function(e) {
            e.preventDefault();
            
            const formData = {
                title: document.getElementById('articleTitle').value,
                excerpt: document.getElementById('articleExcerpt').value,
                content: document.getElementById('articleContent').innerHTML,
                author_name: document.getElementById('authorName').value,
                author_title: document.getElementById('authorTitle').value,
                author_bio: document.getElementById('authorBio').value,
                author_avatar: document.getElementById('authorAvatarPreview').src || null,
                author_website: document.getElementById('authorWebsite').value,
                author_twitter: document.getElementById('authorTwitter').value,
                author_instagram: document.getElementById('authorInstagram').value,
                author_linkedin: document.getElementById('authorLinkedIn').value,
                images: currentArticleImages
            };
            
            const submitBtn = document.querySelector('#articleForm button[type="submit"]');
            const originalText = submitBtn.textContent;
            
            try {
                submitBtn.textContent = 'Publishing...';
                submitBtn.disabled = true;
                
                // Try database first, fallback to demo mode if table doesn't exist
                const { data, error } = await supabase
                    .from('articles')
                    .insert([formData])
                    .select();

                if (error) {
                    console.warn('Database insert failed, using demo mode:', error);
                    // Fallback to demo mode
                    const mockId = 'article_' + Date.now();
                    const articleWithId = { ...formData, id: mockId, created_at: new Date().toISOString() };
                    articles.unshift(articleWithId);
                    filteredArticles = [...articles];
                    alert('Article published successfully!\n\nNote: Running in demo mode. Create the articles table in Supabase to enable full functionality.');
                } else {
                    console.log('Article published to database:', data[0]);
                    await loadArticles();
                    alert('Article published successfully!');
                }
                
                closeWriteArticle();
                renderArticles();
                
            } catch (error) {
                console.error('Error publishing article:', error);
                alert('Failed to publish article. Please try again.');
            } finally {
                submitBtn.textContent = originalText;
                submitBtn.disabled = false;
            }
        });
        
        // Article Reading
        function openArticleReader(articleId) {
            const article = articles.find(a => a.id === articleId);
            if (!article) return;
            
            // Update modal content
            document.getElementById('readerAuthorAvatar').src = article.author_avatar || generateAvatarPlaceholder(article.author_name);
            document.getElementById('readerAuthorName').textContent = article.author_name;
            document.getElementById('readerAuthorTitle').textContent = article.author_title || 'Contributor';
            document.getElementById('readerArticleTitle').textContent = article.title;
            document.getElementById('readerArticleContent').innerHTML = processArticleContent(article.content, article.images);
            
            const publishedDate = new Date(article.created_at).toLocaleDateString('en-US', {
                year: 'numeric',
                month: 'long',
                day: 'numeric'
            });
            const readTime = calculateReadTime(article.content, article.images);
            
            document.getElementById('readerArticleDate').textContent = publishedDate;
            document.getElementById('readerReadTime').textContent = `${readTime} min read`;
            
            // Update social links
            const socialLinks = document.getElementById('readerSocialLinks');
            let linksHTML = '';
            
            if (article.author_website) {
                linksHTML += `<a href="${article.author_website}" target="_blank" class="social-link">Website</a>`;
            }
            if (article.author_twitter) {
                const twitterHandle = article.author_twitter.replace('@', '');
                linksHTML += `<a href="https://twitter.com/${twitterHandle}" target="_blank" class="social-link">Twitter</a>`;
            }
            if (article.author_instagram) {
                const instaHandle = article.author_instagram.replace('@', '');
                linksHTML += `<a href="https://instagram.com/${instaHandle}" target="_blank" class="social-link">Instagram</a>`;
            }
            if (article.author_linkedin) {
                linksHTML += `<a href="${article.author_linkedin}" target="_blank" class="social-link">LinkedIn</a>`;
            }
            
            socialLinks.innerHTML = linksHTML;
            
            document.getElementById('articleReaderModal').classList.add('show');
        }
        
        function closeArticleReader() {
            document.getElementById('articleReaderModal').classList.remove('show');
        }
        
        // Utility Functions
        function calculateReadTime(content, images = []) {
            const wordsPerMinute = 200;
            const secondsPerImage = 12; // Assume 12 seconds per image
            
            const textContent = content.replace(/<[^>]*>/g, '');
            const wordCount = textContent.split(/\s+/).length;
            const textTime = wordCount / wordsPerMinute;
            
            // Add time for images
            const imageTime = (images?.length || 0) * (secondsPerImage / 60);
            
            const totalTime = textTime + imageTime;
            return Math.max(1, Math.ceil(totalTime));
        }
        
        function extractExcerpt(content, maxLength = 150) {
            const textContent = content.replace(/<[^>]*>/g, '');
            return textContent.length > maxLength 
                ? textContent.substring(0, maxLength) + '...'
                : textContent;
        }
        
        function generateAvatarPlaceholder(name) {
            const initials = name.split(' ').map(n => n[0]).join('').toUpperCase();
            return `data:image/svg+xml;base64,${btoa(`
                <svg width="100" height="100" viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg">
                    <circle cx="50" cy="50" r="50" fill="#f0f0f0"/>
                    <text x="50" y="60" text-anchor="middle" fill="#666" font-size="24" font-family="Inter">${initials}</text>
                </svg>
            `)}`;
        }
        
        function processArticleContent(content, images = []) {
            let processedContent = content;
            
            // Add images gallery at the end if there are images
            if (images && images.length > 0) {
                const imagesHTML = `
                    <div class="article-images-gallery">
                        ${images.map(img => `<img src="${img}" alt="Article image" onclick="openImageZoom('${img}')">`).join('')}
                    </div>
                `;
                processedContent += imagesHTML;
            }
            
            return processedContent;
        }
        
        function openImageZoom(imageSrc) {
            document.getElementById('zoomImage').src = imageSrc;
            document.getElementById('zoomModal').classList.add('show');
        }
        // Curator artwork management (reuse existing functions with collection_id)
        async function saveCuratorArtwork(artworkData, collectionId) {
            if (!currentCurator) {
                alert('Please login as a curator to save artworks');
                return;
            }

            try {
                const { data: maxOrderData } = await supabase
                    .from('curator_artworks')
                    .select('display_order')
                    .eq('collection_id', collectionId)
                    .order('display_order', { ascending: false, nullsLast: false })
                    .limit(1);
                
                const maxOrder = maxOrderData && maxOrderData.length > 0 ? maxOrderData[0].display_order : null;
                const newDisplayOrder = maxOrder !== null ? maxOrder + 1 : null;
                
                const { data, error } = await supabase
                    .from('curator_artworks')
                    .insert([{ 
                        ...artworkData, 
                        collection_id: collectionId,
                        curator_id: currentCurator.id,
                        display_order: newDisplayOrder 
                    }])
                    .select();

                if (error) throw error;

                console.log('Curator artwork saved:', data[0]);
                loadCuratorPage(currentCurator.id, collectionId);
                return data[0];
            } catch (error) {
                console.error('Error saving curator artwork:', error);
                alert('Failed to save artwork: ' + error.message);
                throw error;
            }
        }

        async function updateCuratorArtwork(id, artworkData, collectionId) {
            if (!currentCurator) {
                alert('Please login as a curator to update artworks');
                return;
            }

            try {
                const { data, error } = await supabase
                    .from('curator_artworks')
                    .update(artworkData)
                    .eq('id', id)
                    .eq('curator_id', currentCurator.id)
                    .select();

                if (error) throw error;

                console.log('Curator artwork updated:', data[0]);
                loadCuratorPage(currentCurator.id, collectionId);
                return data[0];
            } catch (error) {
                console.error('Error updating curator artwork:', error);
                alert('Failed to update artwork: ' + error.message);
                throw error;
            }
        }

        async function deleteCuratorArtwork(id, collectionId) {
            if (!currentCurator) {
                alert('Please login as a curator to delete artworks');
                return;
            }

            const artwork = artworks.find(a => a.id === id);
            if (!artwork) return;
            
            const confirmMessage = `Are you sure you want to delete "${artwork.title}" by ${artwork.artist}?\n\nThis action cannot be undone.`;
            
            if (!confirm(confirmMessage)) return;

            try {
                const { error } = await supabase
                    .from('curator_artworks')
                    .delete()
                    .eq('id', id)
                    .eq('curator_id', currentCurator.id);

                if (error) throw error;

                console.log('Curator artwork deleted:', artwork.title);
                loadCuratorPage(currentCurator.id, collectionId);
                
                alert(`"${artwork.title}" has been deleted from your collection.`);
            } catch (error) {
                console.error('Error deleting curator artwork:', error);
                alert('Failed to delete artwork: ' + error.message);
            }
        }

        // Performance Optimizations (kept essential ones only)
        function initializeLazyLoading() {
            imageObserver = new IntersectionObserver((entries) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        const img = entry.target;
                        const src = img.getAttribute('data-lazy');
                        if (src) {
                            img.src = src;
                            img.onload = () => {
                                img.classList.add('loaded');
                                img.removeAttribute('data-lazy');
                            };
                            imageObserver.unobserve(img);
                        }
                    }
                });
            }, {
                threshold: 0.1,
                rootMargin: '50px 0px'
            });
        }

        function initializeAnimations() {
            animationObserver = new IntersectionObserver((entries) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        entry.target.classList.add('animate-in');
                    }
                });
            }, {
                threshold: 0.1,
                rootMargin: '30px 0px'
            });
        }

        function animateArtworkCards() {
            if (animationObserver) {
                document.querySelectorAll('.artwork-card').forEach(card => {
                    animationObserver.unobserve(card);
                });
            }

            const cards = document.querySelectorAll('.artwork-card');
            cards.forEach((card, index) => {
                card.style.transitionDelay = `${Math.min(index * 0.05, 0.3)}s`;
                card.classList.remove('animate-in');
                
                if (animationObserver) {
                    animationObserver.observe(card);
                }
            });
            
            initializeImageLazyLoading();
        }

        function initializeImageLazyLoading() {
            const images = document.querySelectorAll('.artwork-image img[data-lazy]');
            images.forEach(img => {
                if (imageObserver) {
                    imageObserver.observe(img);
                }
            });
        }

        // Simple Arrangement System (replaces complex drag & drop)
        function moveArtwork(id, direction) {
            const currentIndex = filteredArtworks.findIndex(a => a.id === id);
            const newIndex = direction === 'up' ? currentIndex - 1 : currentIndex + 1;
            
            if (newIndex >= 0 && newIndex < filteredArtworks.length) {
                // Swap positions
                [filteredArtworks[currentIndex], filteredArtworks[newIndex]] = 
                [filteredArtworks[newIndex], filteredArtworks[currentIndex]];
                
                renderGallery();
                hasUnsavedChanges = true;
                updateCurationStatus();
                
                // Show curation controls
                if (isAdminMode && isAuthenticated) {
                    document.getElementById('curationControls').classList.add('show');
                }
            }
        }

        function updateCurationStatus() {
            const status = document.querySelector('.curation-status');
            if (hasUnsavedChanges) {
                status.textContent = 'Arrangement changed - click Save';
                status.style.color = '#ff6b35';
            } else {
                status.textContent = 'Use ↑↓ arrows to arrange';
                status.style.color = '#666';
            }
        }

        async function saveCurationOrder() {
            if (!hasUnsavedChanges) return;
            
            const saveBtn = document.getElementById('saveCuration');
            const originalText = saveBtn.textContent;
            
            try {
                saveBtn.textContent = 'Saving...';
                saveBtn.classList.add('saving');
                
                const tableName = currentPage === 'curator' ? 'curator_artworks' : 'artworks';
                
                for (let i = 0; i < filteredArtworks.length; i++) {
                    const artwork = filteredArtworks[i];
                    await supabase
                        .from(tableName)
                        .update({ display_order: i })
                        .eq('id', artwork.id);
                }
                
                hasUnsavedChanges = false;
                updateCurationStatus();
                
                saveBtn.textContent = 'Saved!';
                setTimeout(() => {
                    saveBtn.textContent = originalText;
                    saveBtn.classList.remove('saving');
                }, 1500);
                
            } catch (error) {
                console.error('Error saving curation order:', error);
                saveBtn.textContent = 'Error';
                setTimeout(() => {
                    saveBtn.textContent = originalText;
                    saveBtn.classList.remove('saving');
                }, 1500);
            }
        }

        async function resetCurationOrder() {
            if (!confirm('Reset to chronological order? This will undo your custom arrangement.')) return;
            
            try {
                const tableName = currentPage === 'curator' ? 'curator_artworks' : 'artworks';
                
                await supabase
                    .from(tableName)
                    .update({ display_order: null })
                    .neq('id', '');
                
                if (currentPage === 'curator' && currentCollection) {
                    await loadCuratorPage(currentCurator.id, currentCollection);
                } else {
                    await loadArtworks();
                }
                hasUnsavedChanges = false;
                updateCurationStatus();
                
            } catch (error) {
                console.error('Error resetting curation order:', error);
            }
        }

        // Search & Filter Functions (streamlined)
        function setupSearchAndFilters() {
            const searchInput = document.getElementById('searchInput');
            const artistFilter = document.getElementById('artistFilter');
            const yearFilter = document.getElementById('yearFilter');
            const mediumFilter = document.getElementById('mediumFilter');
            const clearFilters = document.getElementById('clearFilters');

            let searchTimeout;
            searchInput.addEventListener('input', function() {
                clearTimeout(searchTimeout);
                searchTimeout = setTimeout(() => {
                    filterAndRenderGallery();
                }, 150);
            });

            artistFilter.addEventListener('change', filterAndRenderGallery);
            yearFilter.addEventListener('change', filterAndRenderGallery);
            mediumFilter.addEventListener('change', filterAndRenderGallery);

            clearFilters.addEventListener('click', function() {
                searchInput.value = '';
                artistFilter.value = '';
                yearFilter.value = '';
                mediumFilter.value = '';
                filterAndRenderGallery();
            });
        }

        function populateFilterDropdowns() {
            if (artworks.length === 0) return;

            const artists = [...new Set(artworks.map(a => a.artist))].sort();
            const years = [...new Set(artworks.map(a => a.year))].sort().reverse();
            const mediums = [...new Set(artworks.map(a => a.medium).filter(m => m))].sort();

            populateSelect('artistFilter', artists);
            populateSelect('yearFilter', years);
            populateSelect('mediumFilter', mediums);

            document.getElementById('galleryControls').style.display = artworks.length > 0 ? 'flex' : 'none';
        }

        function populateSelect(selectId, options) {
            const select = document.getElementById(selectId);
            const currentValue = select.value;
            
            select.innerHTML = select.querySelector('option').outerHTML;
            
            options.forEach(option => {
                const optionElement = document.createElement('option');
                optionElement.value = option;
                optionElement.textContent = option;
                select.appendChild(optionElement);
            });
            
            if (options.includes(currentValue)) {
                select.value = currentValue;
            }
        }

        function filterArtworks() {
            const searchTerm = document.getElementById('searchInput').value.toLowerCase();
            const artistFilter = document.getElementById('artistFilter').value;
            const yearFilter = document.getElementById('yearFilter').value;
            const mediumFilter = document.getElementById('mediumFilter').value;

            filteredArtworks = artworks.filter(artwork => {
                const matchesSearch = !searchTerm || 
                    artwork.title.toLowerCase().includes(searchTerm) ||
                    artwork.artist.toLowerCase().includes(searchTerm);
                
                const matchesArtist = !artistFilter || artwork.artist === artistFilter;
                const matchesYear = !yearFilter || artwork.year === yearFilter;
                const matchesMedium = !mediumFilter || artwork.medium === mediumFilter;

                return matchesSearch && matchesArtist && matchesYear && matchesMedium;
            });

            updateResultsCount();
            return filteredArtworks;
        }

        function updateResultsCount() {
            const count = filteredArtworks.length;
            document.getElementById('resultNumber').textContent = count;
        }

        function filterAndRenderGallery() {
            requestAnimationFrame(() => {
                filterArtworks();
                renderGallery();
            });
        }

        // Authentication functions
        async function checkAuthState() {
            const { data: { session } } = await supabase.auth.getSession();
            if (session) {
                isAuthenticated = true;
                document.getElementById('userEmail').textContent = session.user.email;
                showAdminContent();
            } else {
                isAuthenticated = false;
                showLoginForm();
            }
        }

        function showAdminContent() {
            document.getElementById('loginForm').style.display = 'none';
            document.getElementById('adminContent').style.display = 'block';
            document.getElementById('editAboutBtn').style.display = isAdminMode ? 'block' : 'none';
        }

        function showLoginForm() {
            document.getElementById('loginForm').style.display = 'block';
            document.getElementById('adminContent').style.display = 'none';
            document.getElementById('editAboutBtn').style.display = 'none';
        }

        async function login() {
            const email = document.getElementById('loginEmail').value;
            const password = document.getElementById('loginPassword').value;
            
            if (!email || !password) {
                alert('Please enter both email and password');
                return;
            }

            try {
                const { data, error } = await supabase.auth.signInWithPassword({
                    email: email,
                    password: password
                });

                if (error) throw error;

                isAuthenticated = true;
                document.getElementById('userEmail').textContent = data.user.email;
                showAdminContent();
                alert('Login successful!');
                
                document.getElementById('loginEmail').value = '';
                document.getElementById('loginPassword').value = '';
            } catch (error) {
                console.error('Login error:', error);
                alert('Login failed: ' + error.message);
            }
        }

        async function logout() {
            try {
                const { error } = await supabase.auth.signOut();
                if (error) throw error;

                isAuthenticated = false;
                isAdminMode = false;
                
                // Also logout curator if they were logged in
                if (currentCurator) {
                    currentCurator = null;
                    isCuratorMode = false;
                    resetAdminPanelFromCurator();
                }
                
                showLoginForm();
                const adminPanel = document.getElementById('adminPanel');
                if (adminPanel.classList.contains('open')) {
                    toggleAdmin();
                }
                renderGallery();
                alert('Logged out successfully');
            } catch (error) {
                console.error('Logout error:', error);
                alert('Logout failed: ' + error.message);
            }
        }

        // Admin functions
        function toggleAdmin() {
            const panel = document.getElementById('adminPanel');
            panel.classList.toggle('open');
            isAdminMode = panel.classList.contains('open') && (isAuthenticated || currentCurator);
            
            if (isAdminMode) {
                // Check if curator is logged in
                if (currentCurator) {
                    updateAdminPanelForCurator();
                } else {
                    // Normal admin
                    document.getElementById('editAboutBtn').style.display = 'block';
                    document.getElementById('aboutText').value = aboutText;
                }
            } else {
                document.getElementById('editAboutBtn').style.display = 'none';
                document.getElementById('curationControls').classList.remove('show');
            }
            
            renderGallery();
        }

        // Artwork functions
        async function loadArtworks() {
            try {
                const { data, error } = await supabase
                    .from('artworks')
                    .select('*')
                    .order('display_order', { ascending: true, nullsLast: true })
                    .order('created_at', { ascending: false });

                if (error) throw error;

                artworks = data || [];
                filteredArtworks = [...artworks];
                console.log('Loaded', artworks.length, 'artworks from database');
                
                populateFilterDropdowns();
                renderGallery();
            } catch (error) {
                console.error('Error loading artworks:', error);
                artworks = [];
                filteredArtworks = [];
                renderGallery();
            }
        }

        async function saveArtwork(artworkData) {
            if (!isAuthenticated) {
                alert('Please login to save artworks');
                return;
            }

            try {
                const { data: maxOrderData } = await supabase
                    .from('artworks')
                    .select('display_order')
                    .order('display_order', { ascending: false, nullsLast: false })
                    .limit(1);
                
                const maxOrder = maxOrderData && maxOrderData.length > 0 ? maxOrderData[0].display_order : null;
                const newDisplayOrder = maxOrder !== null ? maxOrder + 1 : null;
                
                const { data, error } = await supabase
                    .from('artworks')
                    .insert([{ ...artworkData, display_order: newDisplayOrder }])
                    .select();

                if (error) throw error;

                console.log('Artwork saved:', data[0]);
                await loadArtworks();
                return data[0];
            } catch (error) {
                console.error('Error saving artwork:', error);
                alert('Failed to save artwork: ' + error.message);
                throw error;
            }
        }

        async function updateArtwork(id, artworkData) {
            if (!isAuthenticated) {
                alert('Please login to update artworks');
                return;
            }

            try {
                const { data, error } = await supabase
                    .from('artworks')
                    .update(artworkData)
                    .eq('id', id)
                    .select();

                if (error) throw error;

                console.log('Artwork updated:', data[0]);
                await loadArtworks();
                return data[0];
            } catch (error) {
                console.error('Error updating artwork:', error);
                alert('Failed to update artwork: ' + error.message);
                throw error;
            }
        }

        async function deleteArtwork(id) {
            if (!isAuthenticated) {
                alert('Please login to delete artworks');
                return;
            }

            const artwork = artworks.find(a => a.id === id);
            if (!artwork) return;
            
            const confirmMessage = `Are you sure you want to delete "${artwork.title}" by ${artwork.artist}?\n\nThis action cannot be undone.`;
            
            if (!confirm(confirmMessage)) return;

            try {
                const { error } = await supabase
                    .from('artworks')
                    .delete()
                    .eq('id', id);

                if (error) throw error;

                console.log('Artwork deleted:', artwork.title);
                await loadArtworks();
                
                alert(`"${artwork.title}" has been deleted from your collection.`);
            } catch (error) {
                console.error('Error deleting artwork:', error);
                alert('Failed to delete artwork: ' + error.message);
            }
        }

        // About section functions
        async function loadAbout() {
            try {
                const { data, error } = await supabase
                    .from('about')
                    .select('content')
                    .order('updated_at', { ascending: false })
                    .limit(1);

                if (error) throw error;

                if (data && data.length > 0) {
                    aboutText = data[0].content;
                    document.getElementById('aboutContent').innerHTML = aboutText.split('\n').map(p => `<p>${p}</p>`).join('');
                }
            } catch (error) {
                console.error('Error loading about:', error);
            }
        }

        async function saveAbout() {
            if (!isAuthenticated) {
                alert('Please login to update about section');
                return;
            }

            aboutText = document.getElementById('aboutText').value;

            try {
                const { data: existingData } = await supabase
                    .from('about')
                    .select('id')
                    .limit(1);

                if (existingData && existingData.length > 0) {
                    const { error } = await supabase
                        .from('about')
                        .update({ content: aboutText, updated_at: new Date().toISOString() })
                        .eq('id', existingData[0].id);

                    if (error) throw error;
                } else {
                    const { error } = await supabase
                        .from('about')
                        .insert([{ content: aboutText }]);

                    if (error) throw error;
                }

                document.getElementById('aboutContent').innerHTML = aboutText.split('\n').map(p => `<p>${p}</p>`).join('');
                alert('About section updated successfully!');
            } catch (error) {
                console.error('Error saving about:', error);
                alert('Failed to save about section: ' + error.message);
            }
        }

        function editAbout() {
            document.getElementById('aboutText').value = aboutText;
            document.getElementById('aboutText').focus();
        }

        // Image compression
        function compressImage(file, maxWidth = 600, quality = 0.85) {
            return new Promise((resolve) => {
                const canvas = document.createElement('canvas');
                const ctx = canvas.getContext('2d');
                const img = new Image();
                
                img.onload = function() {
                    let { width, height } = img;
                    
                    const isMobile = window.innerWidth <= 768;
                    const targetMaxWidth = isMobile ? 400 : maxWidth;
                    
                    if (width > targetMaxWidth) {
                        height = (height * targetMaxWidth) / width;
                        width = targetMaxWidth;
                    }
                    
                    canvas.width = width;
                    canvas.height = height;
                    
                    ctx.drawImage(img, 0, 0, width, height);
                    const compressedDataUrl = canvas.toDataURL('image/jpeg', quality);
                    
                    console.log('Compressed image from', file.size, 'bytes to', Math.round(compressedDataUrl.length * 0.75), 'bytes');
                    resolve(compressedDataUrl);
                };
                
                img.src = URL.createObjectURL(file);
            });
        }

        // Form handling
        document.getElementById('artworkForm').addEventListener('submit', async function(e) {
            e.preventDefault();
            
            if (!isAuthenticated) {
                alert('Please login to add artworks');
                return;
            }

            const formData = {
                title: document.getElementById('artworkTitle').value,
                artist: document.getElementById('artistName').value,
                year: document.getElementById('artworkYear').value,
                dimensions: document.getElementById('artworkDimensions').value,
                medium: document.getElementById('artworkMedium').value,
                price: document.getElementById('artworkPrice').value,
                orientation: document.getElementById('orientation').value,
                images: []
            };

            const imageFiles = document.getElementById('imageUpload').files;
            const submitBtn = document.querySelector('.btn[type="submit"]');
            const originalText = submitBtn.textContent;
            
            try {
                if (imageFiles.length > 0) {
                    submitBtn.textContent = 'Processing images...';
                    submitBtn.disabled = true;
                    
                    for (let i = 0; i < imageFiles.length; i++) {
                        const file = imageFiles[i];
                        const fileSizeMB = file.size / (1024 * 1024);
                        
                        if (fileSizeMB > 2) {
                            const compressedDataUrl = await compressImage(file, 800, 0.7);
                            formData.images.push(compressedDataUrl);
                        } else {
                            const dataUrl = await new Promise((resolve) => {
                                const reader = new FileReader();
                                reader.onload = (e) => resolve(e.target.result);
                                reader.readAsDataURL(file);
                            });
                            formData.images.push(dataUrl);
                        }
                    }
                } else {
                    const editingId = document.getElementById('editingId').value;
                    if (editingId) {
                        const existing = artworks.find(a => a.id === editingId);
                        if (existing) {
                            formData.images = existing.images;
                        }
                    } else {
                        alert('Please select at least one image for the artwork.');
                        return;
                    }
                }

                submitBtn.textContent = 'Saving...';

                const editingId = document.getElementById('editingId').value;
                if (editingId) {
                    if (currentPage === 'curator' && currentCollection) {
                        await updateCuratorArtwork(editingId, formData, currentCollection);
                    } else {
                        await updateArtwork(editingId, formData);
                    }
                } else {
                    if (currentPage === 'curator' && currentCollection) {
                        await saveCuratorArtwork(formData, currentCollection);
                    } else {
                        await saveArtwork(formData);
                    }
                }

                resetForm();
                alert('Artwork saved successfully!');
            } catch (error) {
                console.error('Error saving artwork:', error);
            } finally {
                submitBtn.textContent = originalText;
                submitBtn.disabled = false;
            }
        });

        function resetForm() {
            document.getElementById('artworkForm').reset();
            document.getElementById('editingId').value = '';
            document.querySelector('.btn[type="submit"]').textContent = 'Add Artwork';
            document.querySelector('.upload-text').textContent = 'Click to upload images (multiple allowed)';
            document.getElementById('imagePreview').innerHTML = '';
        }

        function editArtworkForm(id) {
            const artwork = artworks.find(a => a.id === id);
            if (artwork) {
                document.getElementById('editingId').value = id;
                document.getElementById('artworkTitle').value = artwork.title;
                document.getElementById('artistName').value = artwork.artist;
                document.getElementById('artworkYear').value = artwork.year;
                document.getElementById('artworkDimensions').value = artwork.dimensions || '';
                document.getElementById('artworkMedium').value = artwork.medium || '';
                document.getElementById('artworkPrice').value = artwork.price || '';
                document.getElementById('orientation').value = artwork.orientation;
                document.querySelector('.btn[type="submit"]').textContent = 'Update Artwork';
                document.querySelector('.upload-text').textContent = 'Current images will be kept if none selected';
                
                const preview = document.getElementById('imagePreview');
                preview.innerHTML = artwork.images.map((img, index) => 
                    `<img src="${img}" style="width: 80px; height: 60px; object-fit: cover; margin-right: 10px; border: 1px solid #e0e0e0;">`
                ).join('');
            }
        }

        // Gallery rendering
        function renderGallery() {
            const grid = document.getElementById('galleryGrid');
            
            if (artworks.length === 0) {
                grid.innerHTML = `
                    <div class="empty-gallery">
                        <h3>No Artworks Yet</h3>
                        <p>Add your first artwork using the admin panel.<br>Click the diamond in the bottom-right corner to get started.</p>
                    </div>
                `;
                return;
            }

            if (filteredArtworks.length === 0) {
                grid.innerHTML = `
                    <div class="empty-gallery">
                        <h3>No Results Found</h3>
                        <p>Try adjusting your search terms or filters to find what you're looking for.</p>
                    </div>
                `;
                return;
            }

            grid.innerHTML = filteredArtworks.map((artwork, index) => `
                <div class="artwork-card" onclick="openModal('${artwork.id}')">
                    <div class="artwork-image ${artwork.orientation}">
                        ${artwork.images && artwork.images.length > 0 ? 
                            `<img ${index < 6 ? `src="${artwork.images[0]}" onload="this.classList.add('loaded')"` : `data-lazy="${artwork.images[0]}"`} alt="${artwork.title}" ${index >= 6 ? 'loading="lazy"' : ''}>` 
                            : ''
                        }
                        ${artwork.images && artwork.images.length > 1 ? `<div style="position: absolute; top: 10px; left: 10px; background: rgba(255,255,255,0.8); padding: 4px 8px; font-size: 10px; text-transform: uppercase; letter-spacing: 1px;">${artwork.images.length} Images</div>` : ''}
                        ${isAdminMode && isAuthenticated ? `
                            <div class="admin-controls">
                                ${index > 0 ? `<button class="admin-btn" onclick="event.stopPropagation(); moveArtwork('${artwork.id}', 'up')" title="Move up">↑</button>` : ''}
                                ${index < filteredArtworks.length - 1 ? `<button class="admin-btn" onclick="event.stopPropagation(); moveArtwork('${artwork.id}', 'down')" title="Move down">↓</button>` : ''}
                                <button class="admin-btn" onclick="event.stopPropagation(); editArtworkForm('${artwork.id}')" title="Edit">✎</button>
                                <button class="admin-btn danger" onclick="event.stopPropagation(); ${currentPage === 'curator' && currentCollection ? `deleteCuratorArtwork('${artwork.id}', '${currentCollection}')` : `deleteArtwork('${artwork.id}')`}" title="Delete">×</button>
                            </div>
                        ` : ''}
                    </div>
                    <div class="artwork-info">
                        <div class="artwork-title">${artwork.title}</div>
                        <div class="artwork-details">
                            <div class="artwork-artist">${artwork.artist}</div>
                            <div>${artwork.year}</div>
                            ${artwork.dimensions ? `<div style="margin-top: 3px;">${artwork.dimensions}</div>` : ''}
                            ${artwork.medium ? `<div style="margin-top: 3px; font-style: italic;">${artwork.medium}</div>` : ''}
                            ${artwork.price ? `<div class="artwork-price">${artwork.price}</div>` : ''}
                        </div>
                    </div>
                </div>
            `).join('');

            setTimeout(() => {
                animateArtworkCards();
            }, 10);
        }

        // Modal functions
        function openModal(id) {
            const artwork = artworks.find(a => a.id === id);
            if (artwork) {
                currentModalImages = artwork.images || [];
                currentImageIndex = 0;
                
                updateModalImage();
                
                document.getElementById('modalTitle').textContent = artwork.title;
                document.getElementById('modalArtist').textContent = artwork.artist;
                
                let details = artwork.year;
                if (artwork.dimensions) {
                    details += ` • ${artwork.dimensions}`;
                }
                if (artwork.medium) {
                    details += `\n${artwork.medium}`;
                }
                document.getElementById('modalDetails').innerHTML = details.replace('\n', '<br><em style="font-style: italic; color: #999;">') + (artwork.medium ? '</em>' : '');
                
                const priceElement = document.getElementById('modalPrice');
                if (artwork.price) {
                    priceElement.textContent = artwork.price;
                    priceElement.style.display = 'block';
                } else {
                    priceElement.style.display = 'none';
                }
                
                setupImageNavigation();
                document.getElementById('artworkModal').classList.add('show');
            }
        }

        function updateModalImage() {
            if (currentModalImages.length > 0) {
                document.getElementById('modalImage').src = currentModalImages[currentImageIndex];
            }
        }

        function setupImageNavigation() {
            const prevBtn = document.getElementById('prevBtn');
            const nextBtn = document.getElementById('nextBtn');
            const dotsContainer = document.getElementById('imageDots');
            
            if (currentModalImages.length <= 1) {
                prevBtn.style.display = 'none';
                nextBtn.style.display = 'none';
                dotsContainer.style.display = 'none';
            } else {
                prevBtn.style.display = 'block';
                nextBtn.style.display = 'block';
                dotsContainer.style.display = 'flex';
                
                dotsContainer.innerHTML = currentModalImages.map((_, index) => 
                    `<div class="dot ${index === currentImageIndex ? 'active' : ''}" onclick="goToImage(${index})"></div>`
                ).join('');
                
                prevBtn.disabled = currentImageIndex === 0;
                nextBtn.disabled = currentImageIndex === currentModalImages.length - 1;
            }
        }

        function changeImage(direction) {
            currentImageIndex += direction;
            if (currentImageIndex < 0) currentImageIndex = 0;
            if (currentImageIndex >= currentModalImages.length) currentImageIndex = currentModalImages.length - 1;
            
            updateModalImage();
            setupImageNavigation();
        }

        function goToImage(index) {
            currentImageIndex = index;
            updateModalImage();
            setupImageNavigation();
        }

        function closeModal() {
            document.getElementById('artworkModal').classList.remove('show');
        }

        function openZoom() {
            const currentImage = document.getElementById('modalImage').src;
            document.getElementById('zoomImage').src = currentImage;
            document.getElementById('zoomModal').classList.add('show');
        }

        function closeZoom() {
            document.getElementById('zoomModal').classList.remove('show');
        }

        // Event listeners
        document.getElementById('artworkModal').addEventListener('click', function(e) {
            if (e.target === this) closeModal();
        });

        document.getElementById('zoomModal').addEventListener('click', function(e) {
            if (e.target === this) closeZoom();
        });

        document.getElementById('writeArticleModal').addEventListener('click', function(e) {
            if (e.target === this) closeWriteArticle();
        });

        document.getElementById('articleReaderModal').addEventListener('click', function(e) {
            if (e.target === this) closeArticleReader();
        });

        document.addEventListener('click', function(e) {
            const adminPanel = document.getElementById('adminPanel');
            const adminTrigger = document.querySelector('.admin-trigger');
            
            if (adminPanel.classList.contains('open') && 
                !adminPanel.contains(e.target) && 
                !adminTrigger.contains(e.target)) {
                toggleAdmin();
            }
        });

        document.querySelectorAll('a[href^="#"]').forEach(anchor => {
            anchor.addEventListener('click', function (e) {
                e.preventDefault();
                const target = document.querySelector(this.getAttribute('href'));
                if (target) {
                    target.scrollIntoView({
                        behavior: 'smooth',
                        block: 'start'
                    });
                }
            });
        });

        const fileInput = document.getElementById('imageUpload');
        fileInput.addEventListener('change', function() {
            const files = this.files;
            const preview = document.getElementById('imagePreview');
            
            if (files.length > 0) {
                document.querySelector('.upload-text').textContent = `${files.length} image(s) selected`;
                
                preview.innerHTML = '';
                for (let i = 0; i < Math.min(files.length, 5); i++) {
                    const reader = new FileReader();
                    reader.onload = function(e) {
                        const img = document.createElement('img');
                        img.src = e.target.result;
                        img.style.cssText = 'width: 80px; height: 60px; object-fit: cover; margin-right: 10px; border: 1px solid #e0e0e0;';
                        preview.appendChild(img);
                    };
                    reader.readAsDataURL(files[i]);
                }
                
                if (files.length > 5) {
                    const moreText = document.createElement('span');
                    moreText.textContent = `+${files.length - 5} more`;
                    moreText.style.cssText = 'font-size: 12px; color: #999; margin-left: 10px;';
                    preview.appendChild(moreText);
                }
            }
        });

        // Curator image upload handler
        const curatorFileInput = document.getElementById('curatorImageUpload');
        if (curatorFileInput) {
            curatorFileInput.addEventListener('change', function() {
                const file = this.files[0];
                const preview = document.getElementById('curatorImagePreview');
                
                if (file) {
                    const reader = new FileReader();
                    reader.onload = function(e) {
                        preview.innerHTML = `<img src="${e.target.result}" style="width: 80px; height: 80px; border-radius: 50%; object-fit: cover; border: 1px solid #e0e0e0;">`;
                    };
                    reader.readAsDataURL(file);
                }
            });
        }

        document.addEventListener('keydown', function(e) {
            const modal = document.getElementById('artworkModal');
            const zoomModal = document.getElementById('zoomModal');
            
            if (zoomModal.classList.contains('show')) {
                if (e.key === 'Escape') closeZoom();
            } else if (modal.classList.contains('show')) {
                if (e.key === 'ArrowLeft') changeImage(-1);
                else if (e.key === 'ArrowRight') changeImage(1);
                else if (e.key === 'Escape') closeModal();
                else if (e.key === 'Enter' || e.key === ' ') {
                    e.preventDefault();
                    openZoom();
                }
            }
        }, { passive: false });

        // Setup curation control buttons
        document.getElementById('saveCuration').addEventListener('click', saveCurationOrder);
        document.getElementById('resetCuration').addEventListener('click', resetCurationOrder);

        // Cleanup on page unload
        window.addEventListener('beforeunload', () => {
            if (animationObserver) {
                document.querySelectorAll('.artwork-card').forEach(card => {
                    animationObserver.unobserve(card);
                });
            }
            if (imageObserver) {
                document.querySelectorAll('img[data-lazy]').forEach(img => {
                    imageObserver.unobserve(img);
                });
            }
        });
    
    /* === Pending Curator Approval Helpers =================================== */
    async function loadPendingCurators() {
        if (!isAuthenticated || currentCurator) return; // only full admins
        const section = document.getElementById('pendingCuratorsSection');
        const list    = document.getElementById('pendingCuratorsList');
        try {
            const { data, error } = await supabase
                .from('curators')
                .select('*')
                .eq('status', 'pending')
                .order('created_at', { ascending: false });
            if (error) throw error;
            if (data.length) {
                section.style.display = 'block';
                list.innerHTML = data.map(c => `
                    <div style="display:flex;justify-content:space-between;gap:15px;padding:15px;border:1px solid #e5e7eb;border-radius:8px;margin-bottom:10px;background:#fafafa;">
                        <div>
                            <strong style="color:#1f2937;font-size:14px;">${c.name}</strong><br>
                            <span style="font-size:12px;color:#6b7280;">${c.email}</span><br>
                            ${c.bio ? `<em style="font-size:12px;color:#6b7280;">${c.bio.substring(0,120)}${c.bio.length>120?'…':''}</em>` : ''}
                        </div>
                        <div style="display:flex;gap:8px;flex-shrink:0;">
                            <button class="btn btn-small" onclick="approveCurator('${c.id}')">Approve</button>
                            <button class="btn btn-small btn-danger" onclick="rejectCurator('${c.id}')">Reject</button>
                        </div>
                    </div>`).join('');
            } else {
                section.style.display = 'none';
            }
        } catch (err) {
            console.error('loadPendingCurators', err);
            section.style.display = 'none';
        }
    }

    async function approveCurator(id) {
        try {
            const { error } = await supabase
                .from('curators')
                .update({ status: 'approved' })
                .eq('id', id);
            if (error) throw error;
            alert('Curator approved!');
            await loadCurators();
            await loadPendingCurators();
        } catch (err) {
            console.error('approveCurator', err);
            alert('Failed to approve curator: ' + err.message);
        }
    }

    async function rejectCurator(id) {
        if (!confirm('Reject this curator application?')) return;
        try {
            const { error } = await supabase
                .from('curators')
                .delete()
                .eq('id', id);
            if (error) throw error;
            await loadPendingCurators();
        } catch (err) {
            console.error('rejectCurator', err);
            alert('Failed to reject curator: ' + err.message);
        }
    }

    // Extend existing admin helpers
    if (typeof showAdminContent === 'function') {
        const _origShowAdminContent = showAdminContent;
        showAdminContent = function () {
            _origShowAdminContent();
            if (!currentCurator) loadPendingCurators();
        };
    }

    if (typeof toggleAdmin === 'function') {
        const _origToggleAdmin = toggleAdmin;
        toggleAdmin = function () {
            _origToggleAdmin();
            if (document.getElementById('adminPanel').classList.contains('open') && isAuthenticated && !currentCurator) {
                loadPendingCurators();
            }
        };
    }
    /* ========================================================================= */
</script>

<script>
document.addEventListener("DOMContentLoaded", async () => {
  const guestCuratorsContainer = document.querySelector(".hero-tagline");
  const sectionTitle = guestCuratorsContainer.querySelector(".tagline");

  const response = await supabase
    .from("curators")
    .select("*")
    .eq("status", "approved");

  if (response.error) {
    console.error("Error fetching curators:", response.error);
    sectionTitle.insertAdjacentHTML("afterend", "<p style='text-align:center;color:#888;'>Error loading curators.</p>");
    return;
  }

  const curators = response.data;
  console.log("Approved curators found:", curators);

  if (!curators.length) {
    sectionTitle.insertAdjacentHTML("afterend", "<p style='text-align:center;color:#888;'>No guest curators have been approved yet.</p>");
    return;
  }

  const displayWrapper = document.createElement("div");
  displayWrapper.style.maxWidth = "1000px";
  displayWrapper.style.margin = "40px auto";
  displayWrapper.style.display = "grid";
  displayWrapper.style.gap = "30px";
  displayWrapper.style.gridTemplateColumns = "repeat(auto-fit, minmax(240px, 1fr))";

  guestCuratorsContainer.appendChild(displayWrapper);

  for (const curator of curators) {
    const collectionsRes = await supabase
      .from("curator_collections")
      .select("*")
      .eq("curator_id", curator.id);

    console.log(`Curator ${curator.name || curator.email} collections:`, collectionsRes.data);

    const card = document.createElement("div");
    card.style.border = "1px solid #eee";
    card.style.padding = "20px";
    card.style.borderRadius = "12px";
    card.style.background = "#fff";
    card.style.boxShadow = "0 2px 10px rgba(0,0,0,0.05)";
    card.style.transition = "transform 0.2s";
    card.style.cursor = "pointer";

    card.onmouseenter = () => (card.style.transform = "translateY(-4px)");
    card.onmouseleave = () => (card.style.transform = "translateY(0)");

    const name = curator.name || curator.email || "Unnamed Curator";

    card.innerHTML = `
      <h3 style="font-size: 16px; font-weight: 600; margin-bottom: 10px; color: #1f2937;">${name}</h3>
      <div style="font-size: 13px; color: #666;">${collectionsRes.data?.length || 0} collection(s)</div>
      <div style="margin-top: 12px; font-size: 12px; color: #999;">Click to view (future feature)</div>
    `;

    displayWrapper.appendChild(card);
  }
});
</script>


<script>
// Curator modal setup
const curatorModal = document.createElement("div");
curatorModal.id = "curatorModal";
curatorModal.style.position = "fixed";
curatorModal.style.top = "0";
curatorModal.style.left = "0";
curatorModal.style.width = "100%";
curatorModal.style.height = "100%";
curatorModal.style.background = "rgba(0,0,0,0.75)";
curatorModal.style.display = "none";
curatorModal.style.alignItems = "center";
curatorModal.style.justifyContent = "center";
curatorModal.style.zIndex = "5000";
curatorModal.innerHTML = '<div style="background:#fff;max-width:600px;width:90%;padding:30px;border-radius:12px;position:relative;"><button onclick="closeCuratorModal()" style="position:absolute;top:10px;right:15px;font-size:18px;">×</button><div id="curatorModalContent"></div></div>';
document.body.appendChild(curatorModal);

function closeCuratorModal() {
  curatorModal.style.display = "none";
  document.getElementById("curatorModalContent").innerHTML = "";
}

function showAllCurators() {
  const main = document.querySelector("main");
  main.innerHTML = `
    <section class="hero-tagline">
      <div class="container">
        <h1 class="tagline">Guest Curators</h1>
        <div id="curatorBrowser" style="margin-top:40px;"></div>
      </div>
    </section>
  `;

  loadApprovedCurators();
}

async function loadApprovedCurators() {
  const container = document.getElementById("curatorBrowser");
  const { data: curators, error } = await supabase
    .from("curators")
    .select("*")
    .eq("status", "approved");

  if (error) {
    console.error("Error fetching curators:", error);
    container.innerHTML = "<p style='text-align:center;color:#888;'>Failed to load guest curators.</p>";
    return;
  }

  if (!curators.length) {
    container.innerHTML = "<p style='text-align:center;color:#888;'>No guest curators have been approved yet.</p>";
    return;
  }

  const grid = document.createElement("div");
  grid.style.maxWidth = "1000px";
  grid.style.margin = "0 auto";
  grid.style.display = "grid";
  grid.style.gap = "30px";
  grid.style.gridTemplateColumns = "repeat(auto-fit, minmax(240px, 1fr))";
  container.appendChild(grid);

  for (const curator of curators) {
    const { data: collections } = await supabase
      .from("curator_collections")
      .select("*")
      .eq("curator_id", curator.id);

    const card = document.createElement("div");
    card.style.border = "1px solid #eee";
    card.style.padding = "20px";
    card.style.borderRadius = "12px";
    card.style.background = "#fff";
    card.style.boxShadow = "0 2px 10px rgba(0,0,0,0.05)";
    card.style.transition = "transform 0.2s";
    card.style.cursor = "pointer";

    card.onmouseenter = () => (card.style.transform = "translateY(-4px)");
    card.onmouseleave = () => (card.style.transform = "translateY(0)");
    card.onclick = () => openCuratorModal(curator, collections);

    const name = curator.name || curator.email || "Unnamed Curator";
    card.innerHTML = `
      <h3 style="font-size: 16px; font-weight: 600; margin-bottom: 10px; color: #1f2937;">${name}</h3>
      <div style="font-size: 13px; color: #666;">${collections.length} collection(s)</div>
      <div style="margin-top: 12px; font-size: 12px; color: #999;">Click to view collections</div>
    `;
    grid.appendChild(card);
  }
}

function openCuratorModal(curator, collections) {
  const modalContent = document.getElementById("curatorModalContent");
  const name = curator.name || curator.email || "Unnamed Curator";
  let html = `<h2 style="margin-bottom:20px;">${name}'s Collections</h2>`;
  if (collections.length === 0) {
    html += `<p>This curator has not uploaded any collections yet.</p>`;
  } else {
    html += `<ul style="list-style:none;padding:0;">`;
    collections.forEach(col => {
      html += `<li style="margin-bottom:10px;"><strong>${col.name}</strong> — ${col.type || 'Untyped'}</li>`;
    });
    html += `</ul>`;
  }
  modalContent.innerHTML = html;
  curatorModal.style.display = "flex";
}
</script>


<script>
function showAllCurators() {
  const main = document.querySelector("main");
  main.innerHTML = `
    <section class="hero-tagline">
      <div class="container">
        <h1 class="tagline">Guest Curators</h1>
        <div id="curatorBrowser" style="margin-top:40px;"></div>
      </div>
    </section>
  `;
  loadApprovedCurators();
}

const curatorModal = document.createElement("div");
curatorModal.id = "curatorModal";
curatorModal.style.position = "fixed";
curatorModal.style.top = "0";
curatorModal.style.left = "0";
curatorModal.style.width = "100%";
curatorModal.style.height = "100%";
curatorModal.style.background = "rgba(0,0,0,0.75)";
curatorModal.style.display = "none";
curatorModal.style.alignItems = "center";
curatorModal.style.justifyContent = "center";
curatorModal.style.zIndex = "5000";
curatorModal.innerHTML = '<div style="background:#fff;max-width:700px;width:90%;padding:30px;border-radius:12px;position:relative;max-height:90vh;overflow-y:auto;"><button onclick="closeCuratorModal()" style="position:absolute;top:10px;right:15px;font-size:18px;">×</button><div id="curatorModalContent"></div></div>';
document.body.appendChild(curatorModal);

function closeCuratorModal() {
  curatorModal.style.display = "none";
  document.getElementById("curatorModalContent").innerHTML = "";
}

async function loadApprovedCurators() {
  const container = document.getElementById("curatorBrowser");
  const { data: curators, error } = await supabase
    .from("curators")
    .select("*")
    .eq("status", "approved");

  if (error || !curators) {
    container.innerHTML = "<p style='text-align:center;color:#888;'>Failed to load guest curators.</p>";
    return;
  }

  const grid = document.createElement("div");
  grid.style.maxWidth = "1000px";
  grid.style.margin = "0 auto";
  grid.style.display = "grid";
  grid.style.gap = "30px";
  grid.style.gridTemplateColumns = "repeat(auto-fit, minmax(240px, 1fr))";
  container.appendChild(grid);

  for (const curator of curators) {
    const { data: collections } = await supabase
      .from("curator_collections")
      .select("*")
      .eq("curator_id", curator.id);

    const card = document.createElement("div");
    card.style.border = "1px solid #eee";
    card.style.padding = "20px";
    card.style.borderRadius = "12px";
    card.style.background = "#fff";
    card.style.boxShadow = "0 2px 10px rgba(0,0,0,0.05)";
    card.style.transition = "transform 0.2s";
    card.style.cursor = "pointer";

    card.onmouseenter = () => (card.style.transform = "translateY(-4px)");
    card.onmouseleave = () => (card.style.transform = "translateY(0)");
    card.onclick = () => openCuratorModal(curator, collections);

    const name = curator.name || curator.email || "Unnamed Curator";
    card.innerHTML = `
      <h3 style="font-size: 16px; font-weight: 600; margin-bottom: 10px; color: #1f2937;">${name}</h3>
      <div style="font-size: 13px; color: #666;">${collections.length} collection(s)</div>
      <div style="margin-top: 12px; font-size: 12px; color: #999;">Click to view collections</div>
    `;
    grid.appendChild(card);
  }
}

function openCuratorModal(curator, collections) {
  const modalContent = document.getElementById("curatorModalContent");
  const name = curator.name || curator.email || "Unnamed Curator";
  let html = `<h2 style="margin-bottom:20px;">${name}'s Collections</h2>`;

  if (collections.length === 0) {
    html += `<p>This curator has not uploaded any collections yet.</p>`;
  } else {
    html += `<ul style="list-style:none;padding:0;">`;
    for (const col of collections) {
      html += `<li style="margin-bottom:15px;">
        <strong>${col.name}</strong> — ${col.type || 'Untyped'}
        <button onclick="viewCollectionArtworks('${col.id}')" style="margin-left:10px;font-size:12px;">View Artworks</button>
      </li>`;
    }
    html += `</ul>`;
  }

  modalContent.innerHTML = html;
  curatorModal.style.display = "flex";
}

async function viewCollectionArtworks(collectionId) {
  const modalContent = document.getElementById("curatorModalContent");
  const { data: artworks, error } = await supabase
    .from("curator_artworks")
    .select("*")
    .eq("collection_id", collectionId);

  if (error || !artworks || artworks.length === 0) {
    modalContent.innerHTML = "<p>No artworks found for this collection.</p>";
    return;
  }

  let html = "<h3 style='margin-bottom:20px;'>Artworks in Collection</h3>";
  html += "<ul style='list-style:none;padding:0;'>";
  artworks.forEach((art) => {
    html += `<li style="margin-bottom:10px;"><strong>${art.title}</strong> by ${art.artist || 'Unknown'} (${art.year || 'Year N/A'})</li>`;
  });
  html += "</ul>";

  modalContent.innerHTML = html;
}
</script>

</body>
</html>
