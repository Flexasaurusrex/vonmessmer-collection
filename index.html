<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>VonMesser Collection</title>
    
    <!-- Favicon -->
    <link rel="icon" type="image/svg+xml" href="favicon.svg">
    <link rel="icon" type="image/x-icon" href="favicon.ico">
    <link rel="apple-touch-icon" sizes="180x180" href="apple-touch-icon.png">
    <meta name="theme-color" content="#333333">
    
    <!-- Supabase -->
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            background: #ffffff;
            color: #333;
            line-height: 1.6;
            font-weight: 300;
            overflow-x: hidden;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 0 40px;
        }
        
        /* Header */
        header {
            background: #ffffff;
            position: fixed;
            width: 100%;
            top: 0;
            z-index: 1000;
            border-bottom: 1px solid #f0f0f0;
        }
        
        nav {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 30px 0;
        }
        
        .logo {
            display: flex;
            align-items: center;
            text-decoration: none;
            transition: opacity 0.3s ease;
        }
        
        .logo:hover {
            opacity: 0.8;
        }
        
        .nav-links {
            display: flex;
            list-style: none;
            gap: 50px;
        }
        
        .nav-links a {
            text-decoration: none;
            color: #999;
            font-weight: 300;
            font-size: 13px;
            text-transform: uppercase;
            letter-spacing: 1px;
            transition: color 0.3s ease;
        }
        
        .nav-links a:hover {
            color: #333;
        }
        
        /* Admin Trigger Diamond */
        .admin-trigger {
            position: fixed;
            bottom: 30px;
            right: 30px;
            width: 20px;
            height: 20px;
            cursor: pointer;
            z-index: 999;
            opacity: 0.3;
            transition: all 0.3s ease;
        }
        
        .admin-trigger:hover {
            opacity: 0.8;
            transform: scale(1.2);
        }
        
        .admin-trigger svg {
            width: 100%;
            height: 100%;
        }
        
        /* Admin Panel */
        .admin-panel {
            position: fixed;
            top: 0;
            right: -420px;
            width: 400px;
            height: 100vh;
            background: #ffffff;
            border-left: 1px solid #e0e0e0;
            z-index: 2000;
            transition: right 0.3s ease;
            overflow-y: auto;
            overflow-x: hidden;
            padding: 20px;
            box-shadow: -5px 0 15px rgba(0,0,0,0.1);
        }
        
        .admin-panel.open {
            right: 0;
        }
        
        .admin-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
            padding-bottom: 15px;
            border-bottom: 1px solid #f0f0f0;
        }
        
        .admin-title {
            font-size: 16px;
            font-weight: 400;
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        
        .close-admin {
            background: none;
            border: none;
            font-size: 20px;
            cursor: pointer;
            color: #999;
        }
        
        .admin-form {
            margin-bottom: 30px;
        }
        
        .form-group {
            margin-bottom: 20px;
        }
        
        .form-group label {
            display: block;
            font-size: 12px;
            text-transform: uppercase;
            letter-spacing: 1px;
            color: #666;
            margin-bottom: 8px;
        }
        
        .form-group input,
        .form-group select,
        .form-group textarea {
            width: 100%;
            padding: 12px;
            border: 1px solid #e0e0e0;
            background: #fafafa;
            font-size: 14px;
            font-family: inherit;
        }
        
        .form-group input:focus,
        .form-group select:focus,
        .form-group textarea:focus {
            outline: none;
            border-color: #333;
            background: #ffffff;
        }
        
        .file-upload {
            border: 2px dashed #e0e0e0;
            padding: 30px;
            text-align: center;
            cursor: pointer;
            transition: border-color 0.3s ease;
        }
        
        .file-upload:hover {
            border-color: #333;
        }
        
        .file-upload.dragover {
            border-color: #333;
            background: #f8f8f8;
        }
        
        .upload-text {
            font-size: 13px;
            color: #999;
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        
        .btn {
            padding: 12px 24px;
            border: 1px solid #333;
            background: #ffffff;
            color: #333;
            font-size: 12px;
            text-transform: uppercase;
            letter-spacing: 1px;
            cursor: pointer;
            transition: all 0.3s ease;
            width: 100%;
        }
        
        .btn:hover {
            background: #333;
            color: #ffffff;
        }
        
        .btn-danger {
            border-color: #e74c3c;
            color: #e74c3c;
        }
        
        .btn-danger:hover {
            background: #e74c3c;
            color: #ffffff;
        }
        
        /* Login Form */
        .login-form {
            padding: 30px;
            text-align: center;
        }
        
        .login-form h3 {
            font-size: 14px;
            font-weight: 400;
            text-transform: uppercase;
            letter-spacing: 1px;
            margin-bottom: 30px;
            color: #666;
        }
        
        .logout-section {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px;
            border: 1px solid #e0e0e0;
            margin-bottom: 20px;
            background: #f8f8f8;
        }
        
        .user-email {
            font-size: 12px;
            color: #666;
        }
        
        .logout-btn {
            padding: 6px 12px;
            font-size: 10px;
        }
        
        /* Main Content */
        main {
            margin-top: 120px;
            padding: 60px 0 120px;
        }
        
        .page-title {
            margin-bottom: 60px;
        }
        
        .page-title h1 {
            font-size: 13px;
            font-weight: 400;
            color: #999;
            letter-spacing: 2px;
            text-transform: uppercase;
            margin-bottom: 40px;
        }
        
        /* Gallery Masonry Layout */
        .gallery-grid {
            columns: 3;
            column-gap: 30px;
            margin-bottom: 80px;
        }
        
        @media (max-width: 1200px) {
            .gallery-grid {
                columns: 2;
            }
        }
        
        @media (max-width: 768px) {
            .gallery-grid {
                columns: 1;
                column-gap: 0;
            }
        }
        
        .artwork-card {
            break-inside: avoid;
            margin-bottom: 40px;
            cursor: pointer;
            position: relative;
            display: inline-block;
            width: 100%;
        }
        
        .artwork-image {
            width: 100%;
            background: #fafafa;
            margin-bottom: 15px;
            overflow: hidden;
            position: relative;
        }
        
        .artwork-image.landscape {
            aspect-ratio: 4/3;
        }
        
        .artwork-image.portrait {
            aspect-ratio: 3/4;
        }
        
        .artwork-image.square {
            aspect-ratio: 1/1;
        }
        
        .artwork-image.panoramic {
            aspect-ratio: 16/9;
        }
        
        .artwork-image img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            transition: opacity 0.3s ease;
        }
        
        .artwork-card:hover .artwork-image img {
            opacity: 0.9;
        }
        
        .artwork-info {
            text-align: left;
        }
        
        .artwork-title {
            font-size: 13px;
            font-weight: 400;
            color: #333;
            text-transform: uppercase;
            letter-spacing: 1px;
            margin-bottom: 8px;
        }
        
        .artwork-details {
            font-size: 11px;
            color: #999;
            text-transform: uppercase;
            letter-spacing: 1px;
            line-height: 1.4;
        }
        
        .artwork-artist {
            margin-bottom: 3px;
        }
        
        .artwork-price {
            margin-top: 5px;
            color: #666;
        }
        
        .admin-controls {
            position: absolute;
            top: 10px;
            right: 10px;
            opacity: 0;
            transition: opacity 0.3s ease;
        }
        
        .artwork-card:hover .admin-controls {
            opacity: 1;
        }
        
        .admin-btn {
            background: rgba(255, 255, 255, 0.9);
            border: none;
            padding: 8px;
            margin-left: 5px;
            cursor: pointer;
            font-size: 12px;
            border-radius: 2px;
        }
        
        /* Modal */
        .modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            z-index: 3000;
            display: none;
            align-items: center;
            justify-content: center;
            padding: 40px;
        }
        
        .modal.show {
            display: flex;
        }
        
        .modal-content {
            background: #ffffff;
            max-width: 900px;
            width: 100%;
            max-height: 90vh;
            overflow-y: auto;
            position: relative;
        }
        
        .modal-image-container {
            position: relative;
            background: #fafafa;
            display: flex;
            align-items: center;
            justify-content: center;
            min-height: 450px;
            max-height: 70vh;
            padding: 40px;
        }
        
        .modal-image {
            max-width: 100%;
            max-height: calc(70vh - 80px);
            object-fit: contain;
            background: transparent;
            cursor: zoom-in;
            transition: transform 0.3s ease;
            box-shadow: 0 4px 20px rgba(0,0,0,0.1);
        }
        
        .modal-image:hover {
            transform: scale(1.01);
        }
        
        .modal-image-container::after {
            content: '🔍';
            position: absolute;
            bottom: 15px;
            right: 15px;
            background: rgba(0, 0, 0, 0.7);
            color: white;
            padding: 8px 12px;
            border-radius: 20px;
            font-size: 14px;
            opacity: 0;
            transition: opacity 0.3s ease;
            pointer-events: none;
        }
        
        .modal-image-container:hover::after {
            opacity: 1;
        }
        
        .image-nav {
            position: absolute;
            top: 50%;
            transform: translateY(-50%);
            background: rgba(255, 255, 255, 0.9);
            border: none;
            padding: 15px 20px;
            cursor: pointer;
            font-size: 18px;
            color: #333;
            transition: all 0.3s ease;
        }
        
        .image-nav:hover {
            background: rgba(255, 255, 255, 1);
        }
        
        .image-nav.prev {
            left: 20px;
        }
        
        .image-nav.next {
            right: 20px;
        }
        
        .image-nav:disabled {
            opacity: 0.3;
            cursor: not-allowed;
        }
        
        .image-dots {
            position: absolute;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            display: flex;
            gap: 8px;
        }
        
        .dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.5);
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .dot.active {
            background: rgba(255, 255, 255, 1);
        }
        
        .modal-info {
            padding: 30px;
        }
        
        .modal-title {
            font-size: 20px;
            font-weight: 400;
            margin-bottom: 10px;
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        
        .modal-artist {
            font-size: 16px;
            color: #666;
            font-style: italic;
            margin-bottom: 15px;
        }
        
        .modal-details {
            font-size: 14px;
            color: #999;
            line-height: 1.6;
        }
        
        .modal-price {
            font-size: 16px;
            color: #333;
            margin-top: 20px;
            padding-top: 20px;
            border-top: 1px solid #f0f0f0;
        }
        
        .close-modal {
            position: absolute;
            top: 20px;
            right: 20px;
            background: rgba(255, 255, 255, 0.9);
            border: none;
            padding: 15px;
            cursor: pointer;
            font-size: 18px;
            border-radius: 50%;
            width: 45px;
            height: 45px;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
        }
        
        .close-modal:hover {
            background: rgba(255, 255, 255, 1);
            transform: scale(1.1);
        }
        
        /* Zoom Modal */
        .zoom-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.95);
            z-index: 4000;
            display: none;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }
        
        .zoom-modal.show {
            display: flex;
        }
        
        .zoom-image {
            max-width: 95%;
            max-height: 95%;
            object-fit: contain;
            cursor: zoom-out;
        }
        
        .zoom-close {
            position: absolute;
            top: 30px;
            right: 30px;
            background: rgba(255, 255, 255, 0.9);
            border: none;
            padding: 15px;
            cursor: pointer;
            font-size: 20px;
            border-radius: 50%;
            width: 50px;
            height: 50px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        /* About Section */
        .about-section {
            border-top: 1px solid #f0f0f0;
            padding: 80px 0;
        }
        
        .about-content {
            max-width: 700px;
            margin: 0 auto;
            text-align: center;
        }
        
        .about-content h2 {
            font-size: 13px;
            font-weight: 400;
            color: #999;
            margin-bottom: 40px;
            letter-spacing: 2px;
            text-transform: uppercase;
        }
        
        .about-text {
            font-size: 16px;
            color: #666;
            line-height: 1.8;
            text-align: left;
        }
        
        .about-text p {
            margin-bottom: 20px;
        }
        
        .about-text p:last-child {
            margin-bottom: 0;
        }
        
        .edit-about {
            margin-top: 30px;
            text-align: center;
        }
        
        .edit-about-btn {
            background: none;
            border: 1px solid #e0e0e0;
            padding: 10px 20px;
            font-size: 11px;
            text-transform: uppercase;
            letter-spacing: 1px;
            cursor: pointer;
            color: #999;
            transition: all 0.3s ease;
        }
        
        .edit-about-btn:hover {
            border-color: #333;
            color: #333;
        }
        
        /* Contact Section */
        .contact-section {
            border-top: 1px solid #f0f0f0;
            padding: 80px 0;
            text-align: center;
        }
        
        .contact-content h2 {
            font-size: 13px;
            font-weight: 400;
            color: #999;
            margin-bottom: 40px;
            letter-spacing: 2px;
            text-transform: uppercase;
        }
        
        .contact-content p {
            font-size: 14px;
            color: #666;
            margin-bottom: 40px;
            max-width: 500px;
            margin-left: auto;
            margin-right: auto;
            line-height: 1.6;
        }
        
        .contact-email {
            color: #333;
            text-decoration: none;
            font-size: 13px;
            text-transform: uppercase;
            letter-spacing: 1px;
            padding: 15px 0;
            border-bottom: 1px solid #333;
            display: inline-block;
            transition: all 0.3s ease;
        }
        
        .contact-email:hover {
            opacity: 0.6;
        }
        
        /* Footer */
        footer {
            border-top: 1px solid #f0f0f0;
            padding: 60px 0;
            text-align: center;
        }
        
        .loading {
            text-align: center;
            padding: 40px;
            color: #999;
            font-size: 14px;
        }
        
        footer p {
            font-size: 10px;
            color: #ccc;
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        
        /* Mobile Responsive */
        @media (max-width: 768px) {
            .container {
                padding: 0 20px;
            }
            
            .nav-links {
                gap: 25px;
            }
            
            .nav-links a {
                font-size: 11px;
            }
            
            nav {
                padding: 25px 0;
            }
            
            main {
                margin-top: 100px;
                padding: 40px 0 80px;
            }
            
            .admin-panel {
                width: 100%;
                right: -100%;
            }
            
            .modal {
                padding: 10px;
            }
            
            .modal-info {
                padding: 20px;
            }
            
            .modal-image-container {
                min-height: 250px;
                max-height: 50vh;
            }
            
            .artwork-card {
                margin-bottom: 30px;
            }
            
            .zoom-close {
                top: 15px;
                right: 15px;
                width: 40px;
                height: 40px;
                font-size: 16px;
            }
            
            .close-modal {
                width: 40px;
                height: 40px;
                font-size: 16px;
            }
        }
        
        /* Empty state */
        .empty-gallery {
            text-align: center;
            padding: 100px 20px;
            color: #999;
            width: 100%;
            max-width: 600px;
            margin: 0 auto;
        }
        
        .empty-gallery h3 {
            font-size: 16px;
            font-weight: 300;
            text-transform: uppercase;
            letter-spacing: 1px;
            margin-bottom: 20px;
        }
        
        .empty-gallery p {
            font-size: 14px;
            line-height: 1.6;
        }
    </style>
</head>
<body>
    <header>
        <nav class="container">
            <a href="#" class="logo">
                <svg width="85" height="32" viewBox="0 0 85 32" xmlns="http://www.w3.org/2000/svg">
                    <!-- VM monogram -->
                    <g fill="#333" style="font-weight: 400;">
                        <!-- V -->
                        <polygon points="24,3 27,3 32,17 35,3 38,3 31.5,19 28.5,19"/>
                        <!-- M -->
                        <polygon points="40,3 43,3 46,14 49,3 52,3 52,19 49.5,19 49.5,7 47.5,16 44.5,16 42.5,7 42.5,19 40,19"/>
                    </g>
                    
                    <!-- VONMESSER text -->
                    <text x="42.5" y="29" 
                          text-anchor="middle" 
                          fill="#333" 
                          style="font-family: -apple-system, BlinkMacSystemFont, sans-serif; 
                                 font-size: 6px; 
                                 font-weight: 400; 
                                 letter-spacing: 1.8px;">
                        VONMESSER
                    </text>
                </svg>
            </a>
            <ul class="nav-links">
                <li><a href="#physical">Physical Collection</a></li>
                <li><a href="https://linktr.ee/flexasaurusrex" target="_blank" rel="noopener noreferrer">Digital Collection</a></li>
                <li><a href="#about">About</a></li>
                <li><a href="#contact">Contact</a></li>
            </ul>
        </nav>
    </header>

    <!-- Admin Trigger Diamond -->
    <div class="admin-trigger" onclick="toggleAdmin()">
        <svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg">
            <polygon points="10,2 18,10 10,18 2,10" 
                     fill="#333" 
                     stroke="none"/>
        </svg>
    </div>

    <!-- Admin Panel -->
    <div class="admin-panel" id="adminPanel">
        <div class="admin-header">
            <h3 class="admin-title">Admin Panel</h3>
            <button class="close-admin" onclick="toggleAdmin()">×</button>
        </div>
        
        <!-- Login Form (shows when not authenticated) -->
        <div class="login-form" id="loginForm">
            <h3>Admin Login</h3>
            <div class="form-group">
                <label for="loginEmail">Email</label>
                <input type="email" id="loginEmail" required>
            </div>
            <div class="form-group">
                <label for="loginPassword">Password</label>
                <input type="password" id="loginPassword" required>
            </div>
            <button class="btn" onclick="login()">Login</button>
        </div>

        <!-- Admin Content (shows when authenticated) -->
        <div id="adminContent" style="display: none;">
            <div class="logout-section">
                <span class="user-email" id="userEmail"></span>
                <button class="btn logout-btn" onclick="logout()">Logout</button>
            </div>
            
            <form class="admin-form" id="artworkForm">
                <input type="hidden" id="editingId" value="">
                
                <div class="form-group">
                    <label for="artworkTitle">Artwork Title</label>
                    <input type="text" id="artworkTitle" required>
                </div>
                
                <div class="form-group">
                    <label for="artistName">Artist Name</label>
                    <input type="text" id="artistName" required>
                </div>
                
                <div class="form-group">
                    <label for="artworkYear">Year</label>
                    <input type="text" id="artworkYear" required>
                </div>
                
                <div class="form-group">
                    <label for="artworkDimensions">Dimensions</label>
                    <input type="text" id="artworkDimensions" placeholder="e.g., 24 × 36 in or 61 × 91 cm">
                </div>
                
                <div class="form-group">
                    <label for="artworkMedium">Medium</label>
                    <input type="text" id="artworkMedium" placeholder="e.g., Oil on canvas, Archival pigment print on Hahnemühle Photo Rag 308, Mixed media">
                </div>
                
                <div class="form-group">
                    <label for="artworkPrice">Price (Optional)</label>
                    <input type="text" id="artworkPrice" placeholder="e.g., $5,000 or Price on Request">
                </div>
                
                <div class="form-group">
                    <label for="orientation">Orientation</label>
                    <select id="orientation" required>
                        <option value="landscape">Landscape (4:3)</option>
                        <option value="portrait">Portrait (3:4)</option>
                        <option value="square">Square (1:1)</option>
                        <option value="panoramic">Panoramic (16:9)</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label>Artwork Images</label>
                    <div class="file-upload" onclick="document.getElementById('imageUpload').click()">
                        <input type="file" id="imageUpload" style="display: none;" accept="image/*" multiple>
                        <div class="upload-text">Click to upload images (multiple allowed)</div>
                        <div style="font-size: 10px; color: #999; margin-top: 8px; text-transform: none; letter-spacing: 0;">
                            Tip: For best performance, use images under 2MB each
                        </div>
                    </div>
                    <div id="imagePreview" style="margin-top: 15px;"></div>
                </div>
                
                <button type="submit" class="btn">Add Artwork</button>
                <button type="button" class="btn" onclick="resetForm()" style="margin-top: 10px;">Clear Form</button>
            </form>
            
            <div class="admin-form" style="border-top: 1px solid #f0f0f0; padding-top: 30px; margin-top: 30px;">
                <h4 style="font-size: 12px; text-transform: uppercase; letter-spacing: 1px; color: #666; margin-bottom: 20px;">About Section</h4>
                
                <div class="form-group">
                    <label for="aboutText">About Text</label>
                    <textarea id="aboutText" rows="8" placeholder="Write about yourself as a collector and curator..."></textarea>
                </div>
                
                <button type="button" class="btn" onclick="saveAbout()">Update About</button>
            </div>
        </div>
    </div>

    <!-- Artwork Modal -->
    <div class="modal" id="artworkModal">
        <div class="modal-content">
            <button class="close-modal" onclick="closeModal()">×</button>
            <div class="modal-image-container">
                <img class="modal-image" id="modalImage" src="" alt="" onclick="openZoom()">
                <button class="image-nav prev" id="prevBtn" onclick="changeImage(-1)">‹</button>
                <button class="image-nav next" id="nextBtn" onclick="changeImage(1)">›</button>
                <div class="image-dots" id="imageDots"></div>
            </div>
            <div class="modal-info">
                <h3 class="modal-title" id="modalTitle"></h3>
                <div class="modal-artist" id="modalArtist"></div>
                <div class="modal-details" id="modalDetails"></div>
                <div class="modal-price" id="modalPrice" style="display: none;"></div>
            </div>
        </div>
    </div>

    <!-- Zoom Modal -->
    <div class="zoom-modal" id="zoomModal">
        <button class="zoom-close" onclick="closeZoom()">×</button>
        <img class="zoom-image" id="zoomImage" src="" alt="" onclick="closeZoom()">
    </div>

    <main>
        <div class="container">
            <div class="page-title">
                <h1 id="physical">Current</h1>
            </div>

            <div class="gallery-grid" id="galleryGrid">
                <div class="loading">Loading collection...</div>
            </div>
        </div>
    </main>

    <section id="about" class="about-section">
        <div class="container">
            <div class="about-content">
                <h2>About</h2>
                <div class="about-text" id="aboutContent">
                    <p>Welcome to the VonMesser Collection, a carefully curated assembly of contemporary and classical works that explore the intersection of traditional artistry and modern expression.</p>
                    <p>As a collector and curator, I am drawn to pieces that challenge conventional boundaries while honoring the fundamental principles of artistic excellence. Each work in this collection has been selected for its unique voice, technical mastery, and ability to engage in dialogue with both historical precedent and contemporary discourse.</p>
                </div>
                <div class="edit-about" id="editAboutBtn" style="display: none;">
                    <button class="edit-about-btn" onclick="editAbout()">Edit About</button>
                </div>
            </div>
        </div>
    </section>

    <section id="contact" class="contact-section">
        <div class="container">
            <div class="contact-content">
                <h2>Contact</h2>
                <p>Interested in learning more about the VonMesser Collection or inquiring about specific pieces? We welcome correspondence from collectors, curators, and art enthusiasts.</p>
                <a href="mailto:flexy@capyapp.xyz" class="contact-email">flexy@capyapp.xyz</a>
            </div>
        </div>
    </section>

    <footer>
        <div class="container">
            <p>&copy; 2024 VonMesser Collection</p>
        </div>
    </footer>

    <script>
        // Initialize Supabase
        const supabaseUrl = 'https://qqkshpkbfixeyusqpsou.supabase.co';
        const supabaseKey = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InFxa3NocGtiZml4ZXl1c3Fwc291Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDg5Mjc1ODksImV4cCI6MjA2NDUwMzU4OX0.EhAV5EvXDIRPJcp3ipBSqqo6xY6rh8Jghe__XZ4659U';
        const supabase = window.supabase.createClient(supabaseUrl, supabaseKey);

        let artworks = [];
        let isAdminMode = false;
        let isAuthenticated = false;
        let currentModalImages = [];
        let currentImageIndex = 0;
        let aboutText = '';

        // Initialize on page load
        document.addEventListener('DOMContentLoaded', function() {
            checkAuthState();
            loadArtworks();
            loadAbout();
        });

        // Authentication functions
        async function checkAuthState() {
            const { data: { session } } = await supabase.auth.getSession();
            if (session) {
                isAuthenticated = true;
                document.getElementById('userEmail').textContent = session.user.email;
                showAdminContent();
            } else {
                isAuthenticated = false;
                showLoginForm();
            }
        }

        function showAdminContent() {
            document.getElementById('loginForm').style.display = 'none';
            document.getElementById('adminContent').style.display = 'block';
            document.getElementById('editAboutBtn').style.display = isAdminMode ? 'block' : 'none';
        }

        function showLoginForm() {
            document.getElementById('loginForm').style.display = 'block';
            document.getElementById('adminContent').style.display = 'none';
            document.getElementById('editAboutBtn').style.display = 'none';
        }

        async function login() {
            const email = document.getElementById('loginEmail').value;
            const password = document.getElementById('loginPassword').value;
            
            if (!email || !password) {
                alert('Please enter both email and password');
                return;
            }

            try {
                const { data, error } = await supabase.auth.signInWithPassword({
                    email: email,
                    password: password
                });

                if (error) throw error;

                isAuthenticated = true;
                document.getElementById('userEmail').textContent = data.user.email;
                showAdminContent();
                alert('Login successful!');
                
                // Clear login form
                document.getElementById('loginEmail').value = '';
                document.getElementById('loginPassword').value = '';
            } catch (error) {
                console.error('Login error:', error);
                alert('Login failed: ' + error.message);
            }
        }

        async function logout() {
            try {
                const { error } = await supabase.auth.signOut();
                if (error) throw error;

                isAuthenticated = false;
                isAdminMode = false;
                showLoginForm();
                toggleAdmin(); // Close admin panel
                renderGallery(); // Remove admin controls from gallery
                alert('Logged out successfully');
            } catch (error) {
                console.error('Logout error:', error);
                alert('Logout failed: ' + error.message);
            }
        }

        // Admin functions
        function toggleAdmin() {
            const panel = document.getElementById('adminPanel');
            panel.classList.toggle('open');
            isAdminMode = panel.classList.contains('open') && isAuthenticated;
            
            if (isAdminMode) {
                document.getElementById('editAboutBtn').style.display = 'block';
                document.getElementById('aboutText').value = aboutText;
            } else {
                document.getElementById('editAboutBtn').style.display = 'none';
            }
            
            renderGallery();
        }

        // Artwork functions
        async function loadArtworks() {
            try {
                const { data, error } = await supabase
                    .from('artworks')
                    .select('*')
                    .order('created_at', { ascending: false });

                if (error) throw error;

                artworks = data || [];
                console.log('Loaded', artworks.length, 'artworks from database');
                renderGallery();
            } catch (error) {
                console.error('Error loading artworks:', error);
                artworks = [];
                renderGallery();
            }
        }

        async function saveArtwork(artworkData) {
            if (!isAuthenticated) {
                alert('Please login to save artworks');
                return;
            }

            try {
                const { data, error } = await supabase
                    .from('artworks')
                    .insert([artworkData])
                    .select();

                if (error) throw error;

                console.log('Artwork saved:', data[0]);
                await loadArtworks(); // Refresh the gallery
                return data[0];
            } catch (error) {
                console.error('Error saving artwork:', error);
                alert('Failed to save artwork: ' + error.message);
                throw error;
            }
        }

        async function updateArtwork(id, artworkData) {
            if (!isAuthenticated) {
                alert('Please login to update artworks');
                return;
            }

            try {
                const { data, error } = await supabase
                    .from('artworks')
                    .update(artworkData)
                    .eq('id', id)
                    .select();

                if (error) throw error;

                console.log('Artwork updated:', data[0]);
                await loadArtworks(); // Refresh the gallery
                return data[0];
            } catch (error) {
                console.error('Error updating artwork:', error);
                alert('Failed to update artwork: ' + error.message);
                throw error;
            }
        }

        async function deleteArtwork(id) {
            if (!isAuthenticated) {
                alert('Please login to delete artworks');
                return;
            }

            const artwork = artworks.find(a => a.id === id);
            if (!artwork) return;
            
            const confirmMessage = `Are you sure you want to delete "${artwork.title}" by ${artwork.artist}?\n\nThis action cannot be undone.`;
            
            if (!confirm(confirmMessage)) return;

            try {
                const { error } = await supabase
                    .from('artworks')
                    .delete()
                    .eq('id', id);

                if (error) throw error;

                console.log('Artwork deleted:', artwork.title);
                await loadArtworks(); // Refresh the gallery
                
                // Show success message
                alert(`"${artwork.title}" has been deleted from your collection.`);
            } catch (error) {
                console.error('Error deleting artwork:', error);
                alert('Failed to delete artwork: ' + error.message);
            }
        }

        // About section functions
        async function loadAbout() {
            try {
                const { data, error } = await supabase
                    .from('about')
                    .select('content')
                    .order('updated_at', { ascending: false })
                    .limit(1);

                if (error) throw error;

                if (data && data.length > 0) {
                    aboutText = data[0].content;
                    document.getElementById('aboutContent').innerHTML = aboutText.split('\n').map(p => `<p>${p}</p>`).join('');
                }
            } catch (error) {
                console.error('Error loading about:', error);
            }
        }

        async function saveAbout() {
            if (!isAuthenticated) {
                alert('Please login to update about section');
                return;
            }

            aboutText = document.getElementById('aboutText').value;

            try {
                // First, try to update existing record
                const { data: existingData } = await supabase
                    .from('about')
                    .select('id')
                    .limit(1);

                if (existingData && existingData.length > 0) {
                    // Update existing
                    const { error } = await supabase
                        .from('about')
                        .update({ content: aboutText, updated_at: new Date().toISOString() })
                        .eq('id', existingData[0].id);

                    if (error) throw error;
                } else {
                    // Insert new
                    const { error } = await supabase
                        .from('about')
                        .insert([{ content: aboutText }]);

                    if (error) throw error;
                }

                // Update the display
                document.getElementById('aboutContent').innerHTML = aboutText.split('\n').map(p => `<p>${p}</p>`).join('');
                alert('About section updated successfully!');
            } catch (error) {
                console.error('Error saving about:', error);
                alert('Failed to save about section: ' + error.message);
            }
        }

        function editAbout() {
            document.getElementById('aboutText').value = aboutText;
            document.getElementById('aboutText').focus();
        }

        // Image compression function
        function compressImage(file, maxWidth = 800, quality = 0.8) {
            return new Promise((resolve) => {
                const canvas = document.createElement('canvas');
                const ctx = canvas.getContext('2d');
                const img = new Image();
                
                img.onload = function() {
                    let { width, height } = img;
                    
                    if (width > maxWidth) {
                        height = (height * maxWidth) / width;
                        width = maxWidth;
                    }
                    
                    canvas.width = width;
                    canvas.height = height;
                    
                    ctx.drawImage(img, 0, 0, width, height);
                    const compressedDataUrl = canvas.toDataURL('image/jpeg', quality);
                    
                    console.log('Compressed image from', file.size, 'bytes to', Math.round(compressedDataUrl.length * 0.75), 'bytes');
                    resolve(compressedDataUrl);
                };
                
                img.src = URL.createObjectURL(file);
            });
        }

        // Form handling
        document.getElementById('artworkForm').addEventListener('submit', async function(e) {
            e.preventDefault();
            
            if (!isAuthenticated) {
                alert('Please login to add artworks');
                return;
            }

            const formData = {
                title: document.getElementById('artworkTitle').value,
                artist: document.getElementById('artistName').value,
                year: document.getElementById('artworkYear').value,
                dimensions: document.getElementById('artworkDimensions').value,
                medium: document.getElementById('artworkMedium').value,
                price: document.getElementById('artworkPrice').value,
                orientation: document.getElementById('orientation').value,
                images: []
            };

            const imageFiles = document.getElementById('imageUpload').files;
            const submitBtn = document.querySelector('.btn[type="submit"]');
            const originalText = submitBtn.textContent;
            
            try {
                if (imageFiles.length > 0) {
                    submitBtn.textContent = 'Processing images...';
                    submitBtn.disabled = true;
                    
                    for (let i = 0; i < imageFiles.length; i++) {
                        const file = imageFiles[i];
                        const fileSizeMB = file.size / (1024 * 1024);
                        
                        if (fileSizeMB > 2) {
                            const compressedDataUrl = await compressImage(file, 800, 0.7);
                            formData.images.push(compressedDataUrl);
                        } else {
                            const dataUrl = await new Promise((resolve) => {
                                const reader = new FileReader();
                                reader.onload = (e) => resolve(e.target.result);
                                reader.readAsDataURL(file);
                            });
                            formData.images.push(dataUrl);
                        }
                    }
                } else {
                    const editingId = document.getElementById('editingId').value;
                    if (editingId) {
                        const existing = artworks.find(a => a.id === editingId);
                        if (existing) {
                            formData.images = existing.images;
                        }
                    } else {
                        alert('Please select at least one image for the artwork.');
                        return;
                    }
                }

                submitBtn.textContent = 'Saving...';

                const editingId = document.getElementById('editingId').value;
                if (editingId) {
                    await updateArtwork(editingId, formData);
                } else {
                    await saveArtwork(formData);
                }

                resetForm();
                alert('Artwork saved successfully!');
            } catch (error) {
                console.error('Error saving artwork:', error);
            } finally {
                submitBtn.textContent = originalText;
                submitBtn.disabled = false;
            }
        });

        function resetForm() {
            document.getElementById('artworkForm').reset();
            document.getElementById('editingId').value = '';
            document.querySelector('.btn[type="submit"]').textContent = 'Add Artwork';
            document.querySelector('.upload-text').textContent = 'Click to upload images (multiple allowed)';
            document.getElementById('imagePreview').innerHTML = '';
        }

        function editArtworkForm(id) {
            const artwork = artworks.find(a => a.id === id);
            if (artwork) {
                document.getElementById('editingId').value = id;
                document.getElementById('artworkTitle').value = artwork.title;
                document.getElementById('artistName').value = artwork.artist;
                document.getElementById('artworkYear').value = artwork.year;
                document.getElementById('artworkDimensions').value = artwork.dimensions || '';
                document.getElementById('artworkMedium').value = artwork.medium || '';
                document.getElementById('artworkPrice').value = artwork.price || '';
                document.getElementById('orientation').value = artwork.orientation;
                document.querySelector('.btn[type="submit"]').textContent = 'Update Artwork';
                document.querySelector('.upload-text').textContent = 'Current images will be kept if none selected';
                
                const preview = document.getElementById('imagePreview');
                preview.innerHTML = artwork.images.map((img, index) => 
                    `<img src="${img}" style="width: 80px; height: 60px; object-fit: cover; margin-right: 10px; border: 1px solid #e0e0e0;">`
                ).join('');
            }
        }

        // Gallery rendering
        function renderGallery() {
            const grid = document.getElementById('galleryGrid');
            
            if (artworks.length === 0) {
                grid.innerHTML = `
                    <div class="empty-gallery">
                        <h3>No Artworks Yet</h3>
                        <p>Add your first artwork using the admin panel.<br>Click the diamond in the bottom-right corner to get started.</p>
                    </div>
                `;
                return;
            }

            grid.innerHTML = artworks.map(artwork => `
                <div class="artwork-card" onclick="openModal('${artwork.id}')">
                    <div class="artwork-image ${artwork.orientation}">
                        ${artwork.images && artwork.images.length > 0 ? `<img src="${artwork.images[0]}" alt="${artwork.title}">` : ''}
                        ${artwork.images && artwork.images.length > 1 ? `<div style="position: absolute; top: 10px; left: 10px; background: rgba(255,255,255,0.8); padding: 4px 8px; font-size: 10px; text-transform: uppercase; letter-spacing: 1px;">${artwork.images.length} Images</div>` : ''}
                        ${isAdminMode && isAuthenticated ? `
                            <div class="admin-controls">
                                <button class="admin-btn" onclick="event.stopPropagation(); editArtworkForm('${artwork.id}')">✎</button>
                                <button class="admin-btn btn-danger" onclick="event.stopPropagation(); deleteArtwork('${artwork.id}')">×</button>
                            </div>
                        ` : ''}
                    </div>
                    <div class="artwork-info">
                        <div class="artwork-title">${artwork.title}</div>
                        <div class="artwork-details">
                            <div class="artwork-artist">${artwork.artist}</div>
                            <div>${artwork.year}</div>
                            ${artwork.dimensions ? `<div style="margin-top: 3px;">${artwork.dimensions}</div>` : ''}
                            ${artwork.medium ? `<div style="margin-top: 3px; font-style: italic;">${artwork.medium}</div>` : ''}
                            ${artwork.price ? `<div class="artwork-price">${artwork.price}</div>` : ''}
                        </div>
                    </div>
                </div>
            `).join('');
        }

        // Modal functions
        function openModal(id) {
            const artwork = artworks.find(a => a.id === id);
            if (artwork) {
                currentModalImages = artwork.images || [];
                currentImageIndex = 0;
                
                updateModalImage();
                
                document.getElementById('modalTitle').textContent = artwork.title;
                document.getElementById('modalArtist').textContent = artwork.artist;
                
                let details = artwork.year;
                if (artwork.dimensions) {
                    details += ` • ${artwork.dimensions}`;
                }
                if (artwork.medium) {
                    details += `\n${artwork.medium}`;
                }
                document.getElementById('modalDetails').innerHTML = details.replace('\n', '<br><em style="font-style: italic; color: #999;">') + (artwork.medium ? '</em>' : '');
                
                const priceElement = document.getElementById('modalPrice');
                if (artwork.price) {
                    priceElement.textContent = artwork.price;
                    priceElement.style.display = 'block';
                } else {
                    priceElement.style.display = 'none';
                }
                
                setupImageNavigation();
                document.getElementById('artworkModal').classList.add('show');
            }
        }

        function updateModalImage() {
            if (currentModalImages.length > 0) {
                document.getElementById('modalImage').src = currentModalImages[currentImageIndex];
            }
        }

        function setupImageNavigation() {
            const prevBtn = document.getElementById('prevBtn');
            const nextBtn = document.getElementById('nextBtn');
            const dotsContainer = document.getElementById('imageDots');
            
            if (currentModalImages.length <= 1) {
                prevBtn.style.display = 'none';
                nextBtn.style.display = 'none';
                dotsContainer.style.display = 'none';
            } else {
                prevBtn.style.display = 'block';
                nextBtn.style.display = 'block';
                dotsContainer.style.display = 'flex';
                
                dotsContainer.innerHTML = currentModalImages.map((_, index) => 
                    `<div class="dot ${index === currentImageIndex ? 'active' : ''}" onclick="goToImage(${index})"></div>`
                ).join('');
                
                prevBtn.disabled = currentImageIndex === 0;
                nextBtn.disabled = currentImageIndex === currentModalImages.length - 1;
            }
        }

        function changeImage(direction) {
            currentImageIndex += direction;
            if (currentImageIndex < 0) currentImageIndex = 0;
            if (currentImageIndex >= currentModalImages.length) currentImageIndex = currentModalImages.length - 1;
            
            updateModalImage();
            setupImageNavigation();
        }

        function goToImage(index) {
            currentImageIndex = index;
            updateModalImage();
            setupImageNavigation();
        }

        function closeModal() {
            document.getElementById('artworkModal').classList.remove('show');
        }

        function openZoom() {
            const currentImage = document.getElementById('modalImage').src;
            document.getElementById('zoomImage').src = currentImage;
            document.getElementById('zoomModal').classList.add('show');
        }

        function closeZoom() {
            document.getElementById('zoomModal').classList.remove('show');
        }

        // Event listeners
        document.getElementById('artworkModal').addEventListener('click', function(e) {
            if (e.target === this) closeModal();
        });

        document.getElementById('zoomModal').addEventListener('click', function(e) {
            if (e.target === this) closeZoom();
        });

        document.addEventListener('click', function(e) {
            const adminPanel = document.getElementById('adminPanel');
            const adminTrigger = document.querySelector('.admin-trigger');
            
            if (adminPanel.classList.contains('open') && 
                !adminPanel.contains(e.target) && 
                !adminTrigger.contains(e.target)) {
                toggleAdmin();
            }
        });

        document.querySelectorAll('a[href^="#"]').forEach(anchor => {
            anchor.addEventListener('click', function (e) {
                e.preventDefault();
                const target = document.querySelector(this.getAttribute('href'));
                if (target) {
                    target.scrollIntoView({
                        behavior: 'smooth',
                        block: 'start'
                    });
                }
            });
        });

        const fileInput = document.getElementById('imageUpload');
        fileInput.addEventListener('change', function() {
            const files = this.files;
            const preview = document.getElementById('imagePreview');
            
            if (files.length > 0) {
                document.querySelector('.upload-text').textContent = `${files.length} image(s) selected`;
                
                preview.innerHTML = '';
                for (let i = 0; i < Math.min(files.length, 5); i++) {
                    const reader = new FileReader();
                    reader.onload = function(e) {
                        const img = document.createElement('img');
                        img.src = e.target.result;
                        img.style.cssText = 'width: 80px; height: 60px; object-fit: cover; margin-right: 10px; border: 1px solid #e0e0e0;';
                        preview.appendChild(img);
                    };
                    reader.readAsDataURL(files[i]);
                }
                
                if (files.length > 5) {
                    const moreText = document.createElement('span');
                    moreText.textContent = `+${files.length - 5} more`;
                    moreText.style.cssText = 'font-size: 12px; color: #999; margin-left: 10px;';
                    preview.appendChild(moreText);
                }
            }
        });

        document.addEventListener('keydown', function(e) {
            const modal = document.getElementById('artworkModal');
            const zoomModal = document.getElementById('zoomModal');
            
            if (zoomModal.classList.contains('show')) {
                if (e.key === 'Escape') closeZoom();
            } else if (modal.classList.contains('show')) {
                if (e.key === 'ArrowLeft') changeImage(-1);
                else if (e.key === 'ArrowRight') changeImage(1);
                else if (e.key === 'Escape') closeModal();
                else if (e.key === 'Enter' || e.key === ' ') {
                    e.preventDefault();
                    openZoom();
                }
            }
        });
    </script>
</body>
</html>
